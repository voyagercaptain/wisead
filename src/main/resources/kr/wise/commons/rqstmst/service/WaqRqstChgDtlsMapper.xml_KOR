<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.wise.commons.rqstmst.service.WaqRqstChgDtlsMapper" >
  <resultMap id="BaseResultMap" type="kr.wise.commons.rqstmst.service.WaqRqstChgDtls" >
    <id column="RQST_NO" property="rqstNo" jdbcType="VARCHAR" />
    <id column="RQST_SNO" property="rqstSno" jdbcType="DECIMAL" />
    <result column="ITEM_NM" property="itemNm" jdbcType="VARCHAR" />
    <result column="AFTER" property="afterChg" jdbcType="VARCHAR" />
    <result column="BEFORE" property="beforeChg" jdbcType="VARCHAR" />    
  </resultMap>
 
<select id="selectStwdChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '표준단어논리명'
              WHEN B.NO = 2 THEN '표준단어물리명'
              WHEN B.NO = 3 THEN '영문의미'
              WHEN B.NO = 4 THEN '한자명'
              WHEN B.NO = 5 THEN '출처구분'     
              WHEN B.NO = 6 THEN '설명'
              WHEN B.NO = 7 THEN '표준단어구분'
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_STWD_LNM
              WHEN B.NO = 2 THEN AFTER_STWD_PNM
              WHEN B.NO = 3 THEN AFTER_ENG_MEAN
              WHEN B.NO = 4 THEN AFTER_CCH_NM
              WHEN B.NO = 5 THEN AFTER_ORG_DS
              WHEN B.NO = 6 THEN AFTER_OBJ_DESCN
              WHEN B.NO = 7 THEN AFTER_COMM_DTL_CD_NM              
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_STWD_LNM
              WHEN B.NO = 2 THEN BEFORE_STWD_PNM
              WHEN B.NO = 3 THEN BEFORE_ENG_MEAN
              WHEN B.NO = 4 THEN BEFORE_CCH_NM
              WHEN B.NO = 5 THEN BEFORE_ORG_DS       
              WHEN B.NO = 6 THEN BEFORE_OBJ_DESCN
              WHEN B.NO = 7 THEN BEFORE_COMM_DTL_CD_NM               
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.STWD_LNM AS AFTER_STWD_LNM
               ,A.STWD_PNM AS AFTER_STWD_PNM
               ,A.ENG_MEAN AS AFTER_ENG_MEAN
               ,A.CCH_NM AS AFTER_CCH_NM
               ,A.ORG_DS AS AFTER_ORG_DS
               ,A.WD_DCD AS AFTER_WD_DCD           
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,C.COMM_DTL_CD_NM AS AFTER_COMM_DTL_CD_NM
               ,B.STWD_LNM AS BEFORE_STWD_LNM
               ,B.STWD_PNM AS BEFORE_STWD_PNM
               ,B.ENG_MEAN AS BEFORE_ENG_MEAN
               ,B.CCH_NM AS BEFORE_CCH_NM
               ,B.ORG_DS AS BEFORE_ORG_DS
               ,B.WD_DCD AS BEFORE_WD_DCD
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
               ,D.COMM_DTL_CD_NM AS BEFORE_COMM_DTL_CD_NM
          FROM WAQ_STWD A
               LEFT OUTER JOIN WAM_STWD B
                 ON A.STWD_LNM = B.STWD_LNM
                AND A.STWD_PNM = B.STWD_PNM
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'WD_DCD'
                                ) C   
                 ON A.WD_DCD = C.COMM_DTL_CD
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'WD_DCD'
                                ) D   
                 ON A.WD_DCD = D.COMM_DTL_CD             
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 7) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectDmnChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '도메인논리명'
              WHEN B.NO = 2 THEN '도메인물리명'
              WHEN B.NO = 3 THEN '부모도메인명'
              WHEN B.NO = 4 THEN '논리명기준구분'
              WHEN B.NO = 5 THEN '물리명기준구분'
              WHEN B.NO = 6 THEN '도메인그룹명'     
              WHEN B.NO = 7 THEN '인포타입명'
              WHEN B.NO = 8 THEN '코드값유형'
              WHEN B.NO = 9 THEN '코드값부여방식'
              WHEN B.NO = 10 THEN '목록엔터티논리명'
              WHEN B.NO = 11 THEN '목록엔터티물리명'
              WHEN B.NO = 12 THEN '목록어트리뷰트논리명'
              WHEN B.NO = 13 THEN '목록어트리뷰트물리명'
              WHEN B.NO = 14 THEN '데이터형식'
              WHEN B.NO = 15 THEN '설명'
              WHEN B.NO = 16 THEN '출처구분'
              WHEN B.NO = 17 THEN '담당자명'
              WHEN B.NO = 18 THEN '데이터타입'
              WHEN B.NO = 19 THEN '데이터길이'
              WHEN B.NO = 20 THEN '데이터소수점길이'
              WHEN B.NO = 21 THEN '대분류코드'
              
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_DMN_LNM
              WHEN B.NO = 2 THEN AFTER_DMN_PNM
              WHEN B.NO = 3 THEN AFTER_UPP_DMN_LNM
              WHEN B.NO = 4 THEN AFTER_LNM_CRI_DS
              WHEN B.NO = 5 THEN AFTER_PNM_CRI_DS
              WHEN B.NO = 6 THEN AFTER_DMNG_LNM
              WHEN B.NO = 7 THEN AFTER_INFOTP_LNM
              WHEN B.NO = 8 THEN AFTER_CD_VAL_TYP_CD             
              WHEN B.NO = 9 THEN AFTER_CD_VAL_IVW_CD
              WHEN B.NO = 10 THEN AFTER_LST_ENTY_LNM
              WHEN B.NO = 11 THEN AFTER_LST_ENTY_PNM
              WHEN B.NO = 12 THEN AFTER_LST_ATTR_LNM
              WHEN B.NO = 13 THEN AFTER_LST_ATTR_PNM              
              WHEN B.NO = 14 THEN AFTER_DATA_FRM
              WHEN B.NO = 15 THEN AFTER_OBJ_DESCN
              WHEN B.NO = 16 THEN AFTER_DMN_ORG_DS
              WHEN B.NO = 17 THEN AFTER_CRG_USER_NM
              WHEN B.NO = 18 THEN AFTER_DATA_TYPE
              WHEN B.NO = 19 THEN TO_CHAR(AFTER_DATA_LEN)              
              WHEN B.NO = 20 THEN TO_CHAR(AFTER_DATA_SCAL)
              WHEN B.NO = 21 THEN AFTER_DMN_DSCD
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DMN_LNM
              WHEN B.NO = 2 THEN BEFORE_DMN_PNM
              WHEN B.NO = 3 THEN BEFORE_UPP_DMN_LNM
              WHEN B.NO = 4 THEN BEFORE_LNM_CRI_DS
              WHEN B.NO = 5 THEN BEFORE_PNM_CRI_DS
              WHEN B.NO = 6 THEN BEFORE_DMNG_LNM
              WHEN B.NO = 7 THEN BEFORE_INFOTP_LNM
              WHEN B.NO = 8 THEN BEFORE_CD_VAL_TYP_CD             
              WHEN B.NO = 9 THEN BEFORE_CD_VAL_IVW_CD
              WHEN B.NO = 10 THEN BEFORE_LST_ENTY_LNM
              WHEN B.NO = 11 THEN BEFORE_LST_ENTY_PNM
              WHEN B.NO = 12 THEN BEFORE_LST_ATTR_LNM
              WHEN B.NO = 13 THEN BEFORE_LST_ATTR_PNM              
              WHEN B.NO = 14 THEN BEFORE_DATA_FRM
              WHEN B.NO = 15 THEN BEFORE_OBJ_DESCN
              WHEN B.NO = 16 THEN BEFORE_DMN_ORG_DS
              WHEN B.NO = 17 THEN BEFORE_CRG_USER_NM
              WHEN B.NO = 18 THEN BEFORE_DATA_TYPE
              WHEN B.NO = 19 THEN TO_CHAR(BEFORE_DATA_LEN)              
              WHEN B.NO = 20 THEN TO_CHAR(BEFORE_DATA_SCAL)  
              WHEN B.NO = 21 THEN BEFORE_DMN_DSCD           
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DMN_LNM AS AFTER_DMN_LNM
               ,A.DMN_PNM AS AFTER_DMN_PNM
               ,A.UPP_DMN_LNM AS AFTER_UPP_DMN_LNM
               ,A.LNM_CRI_DS AS AFTER_LNM_CRI_DS
               ,A.PNM_CRI_DS AS AFTER_PNM_CRI_DS
               ,A.DMNG_LNM AS AFTER_DMNG_LNM
               ,A.INFOTP_LNM AS AFTER_INFOTP_LNM           
               ,D.COMM_DTL_CD_NM AS AFTER_CD_VAL_TYP_CD
               ,E.COMM_DTL_CD_NM AS AFTER_CD_VAL_IVW_CD
               ,A.LST_ENTY_LNM AS AFTER_LST_ENTY_LNM
               ,A.LST_ENTY_PNM AS AFTER_LST_ENTY_PNM
               ,A.LST_ATTR_LNM AS AFTER_LST_ATTR_LNM
               ,A.LST_ATTR_PNM AS AFTER_LST_ATTR_PNM
               ,A.DATA_FRM AS AFTER_DATA_FRM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,A.DMN_ORG_DS AS AFTER_DMN_ORG_DS
               ,A.CRG_USER_NM AS AFTER_CRG_USER_NM
               ,A.DATA_TYPE AS AFTER_DATA_TYPE
               ,A.DATA_LEN AS AFTER_DATA_LEN
               ,A.DATA_SCAL AS AFTER_DATA_SCAL
               ,B.DMN_LNM AS BEFORE_DMN_LNM
               ,B.DMN_PNM AS BEFORE_DMN_PNM
               ,G.DMN_LNM AS BEFORE_UPP_DMN_LNM
               ,B.LNM_CRI_DS AS BEFORE_LNM_CRI_DS
               ,B.PNM_CRI_DS AS BEFORE_PNM_CRI_DS
               ,H.DMNG_LNM AS BEFORE_DMNG_LNM
               ,I.INFOTP_LNM AS BEFORE_INFOTP_LNM           
               ,J.COMM_DTL_CD_NM AS BEFORE_CD_VAL_TYP_CD
               ,K.COMM_DTL_CD_NM AS BEFORE_CD_VAL_IVW_CD
               ,B.LST_ENTY_LNM AS BEFORE_LST_ENTY_LNM
               ,B.LST_ENTY_PNM AS BEFORE_LST_ENTY_PNM
               ,B.LST_ATTR_LNM AS BEFORE_LST_ATTR_LNM
               ,B.LST_ATTR_PNM AS BEFORE_LST_ATTR_PNM
               ,B.DATA_FRM AS BEFORE_DATA_FRM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
               ,B.DMN_ORG_DS AS BEFORE_DMN_ORG_DS
               ,L.USER_NM AS BEFORE_CRG_USER_NM
               ,I.DATA_TYPE AS BEFORE_DATA_TYPE
               ,I.DATA_LEN AS BEFORE_DATA_LEN
               ,I.DATA_SCAL AS BEFORE_DATA_SCAL
               ,A.DMN_DSCD AS AFTER_DMN_DSCD
               ,B.DMN_DSCD AS BEFORE_DMN_DSCD
          FROM WAQ_DMN A
               LEFT OUTER JOIN WAM_DMN B
                 ON A.DMN_LNM = B.DMN_LNM
<!--                 AND A.DMN_PNM = B.DMN_PNM -->
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CD_VAL_TYP_CD'
                                ) D   
                 ON A.CD_VAL_TYP_CD = D.COMM_DTL_CD
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CD_VAL_IVW_CD'
                                ) E
                 ON A.CD_VAL_IVW_CD = E.COMM_DTL_CD
			   LEFT OUTER JOIN (SELECT DMN_ID, DMN_LNM
                                  FROM WAM_DMN
                                 WHERE REG_TYP_CD IN ('C', 'U')
                               ) G
                 ON B.UPP_DMN_ID = G.DMN_ID
               LEFT OUTER JOIN (SELECT DMNG_ID, DMNG_LNM
                                  FROM WAA_DMNG
                                 WHERE EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                               ) H
                 ON B.DMNG_ID = H.DMNG_ID
               LEFT OUTER JOIN (SELECT INFOTP_ID
                                     , INFOTP_LNM
                                     , DATA_TYPE
                                     , DATA_LEN
                                     , DATA_SCAL
                                  FROM WAA_INFO_TYPE
                                 WHERE EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                               ) I
                 ON B.INFOTP_ID = I.INFOTP_ID
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CD_VAL_TYP_CD'
                                ) J   
                 ON B.CD_VAL_TYP_CD = J.COMM_DTL_CD
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CD_VAL_IVW_CD'
                                ) K
                 ON B.CD_VAL_IVW_CD = K.COMM_DTL_CD
               LEFT OUTER JOIN (SELECT USER_ID, USER_NM
                                  FROM WAA_USER
                                 WHERE EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                   AND REG_TYP_CD IN ('C', 'U')
                               ) L
                 ON B.CRG_USER_ID = L.USER_ID
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 21) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectItemChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '표준용어논리명'
              WHEN B.NO = 2 THEN '표준용어물리명'
              WHEN B.NO = 3 THEN '논리명기준구분'
              WHEN B.NO = 4 THEN '물리명기준구분'
              WHEN B.NO = 5 THEN '도메인명'
              WHEN B.NO = 6 THEN '도메인그룹명'     
              WHEN B.NO = 7 THEN '인포타입명'
              WHEN B.NO = 8 THEN '데이터타입'
              WHEN B.NO = 9 THEN '데이터길이'
              WHEN B.NO = 10 THEN '데이터소수점길이'
              WHEN B.NO = 11 THEN '암호화여부'
              WHEN B.NO = 12 THEN '설명'
              
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_SDITM_LNM
              WHEN B.NO = 2 THEN AFTER_SDITM_PNM
              WHEN B.NO = 3 THEN AFTER_LNM_CRI_DS
              WHEN B.NO = 4 THEN AFTER_PNM_CRI_DS
              WHEN B.NO = 5 THEN AFTER_DMN_LNM
              WHEN B.NO = 6 THEN AFTER_DMNG_LNM
              WHEN B.NO = 7 THEN AFTER_INFOTP_LNM
              WHEN B.NO = 8 THEN AFTER_DATA_TYPE
              WHEN B.NO = 9 THEN TO_CHAR(AFTER_DATA_LEN)              
              WHEN B.NO = 10 THEN TO_CHAR(AFTER_DATA_SCAL)
              WHEN B.NO = 11 THEN AFTER_ENC_YN
              WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_SDITM_LNM
              WHEN B.NO = 2 THEN BEFORE_SDITM_PNM
              WHEN B.NO = 3 THEN BEFORE_LNM_CRI_DS
              WHEN B.NO = 4 THEN BEFORE_PNM_CRI_DS
              WHEN B.NO = 5 THEN BEFORE_DMN_LNM
              WHEN B.NO = 6 THEN BEFORE_DMNG_LNM
              WHEN B.NO = 7 THEN BEFORE_INFOTP_LNM
              WHEN B.NO = 8 THEN BEFORE_DATA_TYPE
              WHEN B.NO = 9 THEN TO_CHAR(BEFORE_DATA_LEN)              
              WHEN B.NO = 10 THEN TO_CHAR(BEFORE_DATA_SCAL)
              WHEN B.NO = 11 THEN BEFORE_ENC_YN
              WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN            
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.SDITM_LNM AS AFTER_SDITM_LNM
               ,A.SDITM_PNM AS AFTER_SDITM_PNM
               ,A.LNM_CRI_DS AS AFTER_LNM_CRI_DS
               ,A.PNM_CRI_DS AS AFTER_PNM_CRI_DS
               ,A.DMN_LNM AS AFTER_DMN_LNM
               ,A.DMNG_LNM AS AFTER_DMNG_LNM
               ,A.INFOTP_LNM AS AFTER_INFOTP_LNM           
               ,A.DATA_TYPE AS AFTER_DATA_TYPE
               ,A.DATA_LEN AS AFTER_DATA_LEN
               ,A.DATA_SCAL AS AFTER_DATA_SCAL
               ,CASE WHEN A.ENC_YN = 'Y' THEN '예'
                     WHEN NVL(A.ENC_YN, 'N') = 'N' THEN '아니오'
                     END AS AFTER_ENC_YN
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.SDITM_LNM AS BEFORE_SDITM_LNM
               ,B.SDITM_PNM AS BEFORE_SDITM_PNM
               ,B.LNM_CRI_DS AS BEFORE_LNM_CRI_DS
               ,B.PNM_CRI_DS AS BEFORE_PNM_CRI_DS
               ,C.DMN_LNM AS BEFORE_DMN_LNM
               ,D.DMNG_LNM AS BEFORE_DMNG_LNM
               ,E.INFOTP_LNM AS BEFORE_INFOTP_LNM           
               ,E.DATA_TYPE AS BEFORE_DATA_TYPE
               ,E.DATA_LEN AS BEFORE_DATA_LEN
               ,E.DATA_SCAL AS BEFORE_DATA_SCAL
              ,CASE WHEN A.ENC_YN = 'Y' THEN '예'
                     WHEN NVL(A.ENC_YN, 'N') = 'N' THEN '아니오'
                     END AS BEFORE_ENC_YN
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_SDITM A
               LEFT OUTER JOIN WAM_SDITM B
                 ON A.SDITM_LNM = B.SDITM_LNM
<!--                 AND A.SDITM_PNM = B.SDITM_PNM -->
			   LEFT OUTER JOIN (SELECT DMN_ID, DMN_LNM
                                  FROM WAM_DMN
                                 WHERE REG_TYP_CD IN ('C', 'U')
                               ) C
                 ON B.DMN_ID = C.DMN_ID
               LEFT OUTER JOIN (SELECT DMNG_ID, DMNG_LNM
                                  FROM WAA_DMNG
                                 WHERE EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                               ) D
                 ON B.DMNG_ID = D.DMNG_ID
               LEFT OUTER JOIN (SELECT INFOTP_ID
                                     , INFOTP_LNM
                                     , DATA_TYPE
                                     , DATA_LEN
                                     , DATA_SCAL
                                  FROM WAA_INFO_TYPE
                                 WHERE EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                               ) E
                 ON B.INFOTP_ID = E.INFOTP_ID
               
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 12) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectPdmTblChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '테이블논리명'
              WHEN B.NO = 2 THEN '테이블물리명'
              WHEN B.NO = 3 THEN '주제영역명'
              WHEN B.NO = 4 THEN '표준적용여부'
              WHEN B.NO = 5 THEN '파티션테이블여부'     
              WHEN B.NO = 6 THEN 'DW대상테이블여부'
              WHEN B.NO = 7 THEN '담당자명'
              WHEN B.NO = 8 THEN '보관주기'
              WHEN B.NO = 9 THEN '삭제기준'
              WHEN B.NO = 10 THEN '삭제방법'
              WHEN B.NO = 11 THEN '백업주기'
              WHEN B.NO = 12 THEN '설명'
              WHEN B.NO = 13 THEN '컬럼갯수'
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_PDM_TBL_LNM
              WHEN B.NO = 2 THEN AFTER_PDM_TBL_PNM
              WHEN B.NO = 3 THEN AFTER_FULL_PATH
              WHEN B.NO = 4 THEN AFTER_STD_APL_YN
              WHEN B.NO = 5 THEN AFTER_PART_TBL_YN
              WHEN B.NO = 6 THEN AFTER_DW_TRG_TBL_YN
              WHEN B.NO = 7 THEN AFTER_CRG_USER_NM
              WHEN B.NO = 8 THEN AFTER_CTD_FCY
              WHEN B.NO = 9 THEN AFTER_DEL_CRI
              WHEN B.NO = 10 THEN AFTER_DEL_MTD
              WHEN B.NO = 11 THEN AFTER_BCK_FCY
              WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
              WHEN B.NO = 13 THEN AFTER_COL_CNT
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_PDM_TBL_LNM
              WHEN B.NO = 2 THEN BEFORE_PDM_TBL_PNM
              WHEN B.NO = 3 THEN BEFORE_FULL_PATH
              WHEN B.NO = 4 THEN BEFORE_STD_APL_YN
              WHEN B.NO = 5 THEN BEFORE_PART_TBL_YN
              WHEN B.NO = 6 THEN BEFORE_DW_TRG_TBL_YN
              WHEN B.NO = 7 THEN BEFORE_CRG_USER_NM
              WHEN B.NO = 8 THEN BEFORE_CTD_FCY
              WHEN B.NO = 9 THEN BEFORE_DEL_CRI
              WHEN B.NO = 10 THEN BEFORE_DEL_MTD
              WHEN B.NO = 11 THEN BEFORE_BCK_FCY
              WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN
              WHEN B.NO = 13 THEN BEFORE_COL_CNT         
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.PDM_TBL_LNM AS AFTER_PDM_TBL_LNM
               ,A.PDM_TBL_PNM AS AFTER_PDM_TBL_PNM
               ,A.FULL_PATH AS AFTER_FULL_PATH
               ,CASE WHEN A.STD_APL_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.STD_APL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_STD_APL_YN
               ,CASE WHEN A.PART_TBL_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.PART_TBL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_PART_TBL_YN
               ,CASE WHEN A.DW_TRG_TBL_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.DW_TRG_TBL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_DW_TRG_TBL_YN
               ,A.CRG_USER_NM AS AFTER_CRG_USER_NM
               ,A.CTD_FCY AS AFTER_CTD_FCY
               ,A.DEL_CRI AS AFTER_DEL_CRI
               ,A.DEL_MTD AS AFTER_DEL_MTD
               ,A.BCK_FCY AS AFTER_BCK_FCY
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,(SELECT TO_CHAR(COUNT(1)) FROM WAQ_PDM_COL 
                  WHERE RQST_NO = #{rqstNo,jdbcType=VARCHAR}
                    AND RQST_SNO = #{rqstSno,jdbcType=VARCHAR}) AS AFTER_COL_CNT
               ,B.PDM_TBL_LNM AS BEFORE_PDM_TBL_LNM
               ,B.PDM_TBL_PNM AS BEFORE_PDM_TBL_PNM
               ,B.FULL_PATH AS BEFORE_FULL_PATH
               ,CASE WHEN B.STD_APL_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.STD_APL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_STD_APL_YN
               ,CASE WHEN B.PART_TBL_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.PART_TBL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_PART_TBL_YN
               ,CASE WHEN B.DW_TRG_TBL_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.DW_TRG_TBL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_DW_TRG_TBL_YN
               ,C.USER_NM AS BEFORE_CRG_USER_NM
               ,B.CTD_FCY AS BEFORE_CTD_FCY
               ,B.DEL_CRI AS BEFORE_DEL_CRI
               ,B.DEL_MTD AS BEFORE_DEL_MTD
               ,B.BCK_FCY AS BEFORE_BCK_FCY
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
               ,(SELECT TO_CHAR(COUNT(1)) FROM WAM_PDM_COL 
                  WHERE PDM_TBL_ID = B.PDM_TBL_ID) AS BEFORE_COL_CNT
          FROM WAQ_PDM_TBL A
               LEFT OUTER JOIN WAM_PDM_TBL B
                 ON A.PDM_TBL_PNM = B.PDM_TBL_PNM
<!--                 AND A.PDM_TBL_LNM = B.PDM_TBL_LNM -->
			   LEFT OUTER JOIN (SELECT USER_ID, USER_NM
                                  FROM WAA_USER
                                 WHERE EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                   AND REG_TYP_CD IN ('C', 'U')
                               ) C
                 ON B.CRG_USER_ID = C.USER_ID
               
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 13) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectPdmColChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '컬럼논리명'
              WHEN B.NO = 2 THEN '컬럼물리명'
              WHEN B.NO = 3 THEN '컬럼순서'
              WHEN B.NO = 4 THEN '데이터타입'
              WHEN B.NO = 5 THEN '데이터길이'     
              WHEN B.NO = 6 THEN '데이터소수점길이'
              WHEN B.NO = 7 THEN 'PK여부'
              WHEN B.NO = 8 THEN 'PK순서'
              WHEN B.NO = 9 THEN 'NOTNULL여부'
              WHEN B.NO = 10 THEN 'DEFAULT값'
              WHEN B.NO = 11 THEN '암호화여부'
              WHEN B.NO = 12 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_PDM_COL_LNM
              WHEN B.NO = 2 THEN AFTER_PDM_COL_PNM
              WHEN B.NO = 3 THEN TO_CHAR(AFTER_COL_ORD)
              WHEN B.NO = 4 THEN AFTER_DATA_TYPE
              WHEN B.NO = 5 THEN TO_CHAR(AFTER_DATA_LEN)
              WHEN B.NO = 6 THEN TO_CHAR(AFTER_DATA_SCAL)
              WHEN B.NO = 7 THEN AFTER_PK_YN
              WHEN B.NO = 8 THEN TO_CHAR(AFTER_PK_ORD)
              WHEN B.NO = 9 THEN AFTER_NONUL_YN
              WHEN B.NO = 10 THEN AFTER_DEFLT_VAL
              WHEN B.NO = 11 THEN AFTER_ENC_YN
              WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_PDM_COL_LNM
              WHEN B.NO = 2 THEN BEFORE_PDM_COL_PNM
              WHEN B.NO = 3 THEN TO_CHAR(BEFORE_COL_ORD)
              WHEN B.NO = 4 THEN BEFORE_DATA_TYPE
              WHEN B.NO = 5 THEN TO_CHAR(BEFORE_DATA_LEN)
              WHEN B.NO = 6 THEN TO_CHAR(BEFORE_DATA_SCAL)
              WHEN B.NO = 7 THEN BEFORE_PK_YN
              WHEN B.NO = 8 THEN TO_CHAR(BEFORE_PK_ORD)
              WHEN B.NO = 9 THEN BEFORE_NONUL_YN
              WHEN B.NO = 10 THEN BEFORE_DEFLT_VAL
              WHEN B.NO = 11 THEN BEFORE_ENC_YN    
              WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.PDM_COL_LNM AS AFTER_PDM_COL_LNM
               ,A.PDM_COL_PNM AS AFTER_PDM_COL_PNM
               ,A.COL_ORD AS AFTER_COL_ORD
               ,A.DATA_TYPE AS AFTER_DATA_TYPE
               ,A.DATA_LEN AS AFTER_DATA_LEN
               ,A.DATA_SCAL AS AFTER_DATA_SCAL
               ,CASE WHEN A.PK_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.PK_YN = 'N' OR A.PK_YN IS NULL THEN '아니오'
                ELSE NULL END END AS AFTER_PK_YN
               ,A.PK_ORD AS AFTER_PK_ORD
               ,CASE WHEN A.NONUL_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.NONUL_YN = 'N' OR A.NONUL_YN IS NULL THEN '아니오'
                ELSE NULL END END AS AFTER_NONUL_YN
               ,A.DEFLT_VAL AS AFTER_DEFLT_VAL
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.PDM_COL_LNM AS BEFORE_PDM_COL_LNM
               ,B.PDM_COL_PNM AS BEFORE_PDM_COL_PNM
               ,B.COL_ORD AS BEFORE_COL_ORD
               ,B.DATA_TYPE AS BEFORE_DATA_TYPE
               ,B.DATA_LEN AS BEFORE_DATA_LEN
               ,B.DATA_SCAL AS BEFORE_DATA_SCAL
               ,CASE WHEN B.PK_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.PK_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_PK_YN
               ,B.PK_ORD AS BEFORE_PK_ORD
               ,CASE WHEN B.NONUL_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.NONUL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_NONUL_YN
               ,B.DEFLT_VAL AS BEFORE_DEFLT_VAL
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
               ,A.ENC_YN AS AFTER_ENC_YN
               ,B.ENC_YN AS BEFORE_ENC_YN
          FROM WAQ_PDM_COL A
               LEFT OUTER JOIN (SELECT A.*
		                                       ,B.PDM_TBL_PNM
		                                  FROM WAM_PDM_COL A
		                                       INNER JOIN WAM_PDM_TBL B
		                                          ON A.PDM_TBL_ID = B.PDM_TBL_ID
		                                         AND A.REG_TYP_CD IN ('C','U')
		                                         AND B.REG_TYP_CD IN ('C','U')
		                                WHERE B.PDM_TBL_PNM = #{searchObj,jdbcType=VARCHAR} ) B
                  ON A.PDM_TBL_PNM = B.PDM_TBL_PNM
                AND A.PDM_COL_PNM = B.PDM_COL_PNM  
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 12) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectPdmRelChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '관계물리명'
              WHEN B.NO = 2 THEN '관계논리명'
              WHEN B.NO = 3 THEN '관계유형'
              WHEN B.NO = 4 THEN '카디널리티유형'
              WHEN B.NO = 5 THEN 'Parent Optionality 유형'     
              WHEN B.NO = 6 THEN '부모엔터티 주제영역명'
              WHEN B.NO = 7 THEN '부모엔터티명'
              WHEN B.NO = 8 THEN '부모엔터티 속성명'
              WHEN B.NO = 9 THEN '자식엔터티 주제영역명'
              WHEN B.NO = 10 THEN '자식엔터티명'
              WHEN B.NO = 11 THEN '자식엔터티 속성명'
              WHEN B.NO = 12 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_PDM_REL_PNM
              WHEN B.NO = 2 THEN AFTER_PDM_REL_LNM
              WHEN B.NO = 3 THEN AFTER_REL_TYP_CD
              WHEN B.NO = 4 THEN AFTER_CRD_TYP_CD
              WHEN B.NO = 5 THEN AFTER_PA_OPT_TYP_CD
              WHEN B.NO = 6 THEN AFTER_PA_SUBJ_PNM
              WHEN B.NO = 7 THEN AFTER_PA_ENTY_PNM
              WHEN B.NO = 8 THEN AFTER_PA_ATTR_PNM
              WHEN B.NO = 9 THEN AFTER_CH_SUBJ_PNM
              WHEN B.NO = 10 THEN AFTER_CH_ENTY_PNM
              WHEN B.NO = 11 THEN AFTER_CH_ATTR_PNM
              WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_PDM_REL_PNM
       		  WHEN B.NO = 2 THEN BEFORE_PDM_REL_LNM
              WHEN B.NO = 3 THEN BEFORE_REL_TYP_CD
              WHEN B.NO = 4 THEN BEFORE_CRD_TYP_CD
              WHEN B.NO = 5 THEN BEFORE_PA_OPT_TYP_CD
              WHEN B.NO = 6 THEN BEFORE_PA_SUBJ_PNM
              WHEN B.NO = 7 THEN BEFORE_PA_ENTY_PNM
              WHEN B.NO = 8 THEN BEFORE_PA_ATTR_PNM
              WHEN B.NO = 9 THEN BEFORE_CH_SUBJ_PNM
              WHEN B.NO = 10 THEN BEFORE_CH_ENTY_PNM
              WHEN B.NO = 11 THEN BEFORE_CH_ATTR_PNM
              WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN  
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.PDM_REL_PNM AS AFTER_PDM_REL_PNM
               ,A.PDM_REL_LNM AS AFTER_PDM_REL_LNM
               ,C.COMM_DTL_CD_NM AS AFTER_REL_TYP_CD
               ,D.COMM_DTL_CD_NM AS AFTER_CRD_TYP_CD
               ,E.COMM_DTL_CD_NM AS AFTER_PA_OPT_TYP_CD
               ,A.PA_SUBJ_PNM AS AFTER_PA_SUBJ_PNM
               ,A.PA_ENTY_PNM AS AFTER_PA_ENTY_PNM
               ,A.PA_ATTR_PNM AS AFTER_PA_ATTR_PNM
               ,A.CH_SUBJ_PNM AS AFTER_CH_SUBJ_PNM
               ,A.CH_ENTY_PNM AS AFTER_CH_ENTY_PNM
               ,A.CH_ATTR_PNM AS AFTER_CH_ATTR_PNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.PDM_REL_PNM AS BEFORE_PDM_REL_PNM
               ,B.PDM_REL_LNM AS BEFORE_PDM_REL_LNM
               ,F.COMM_DTL_CD_NM AS BEFORE_REL_TYP_CD
               ,G.COMM_DTL_CD_NM AS BEFORE_CRD_TYP_CD
               ,H.COMM_DTL_CD_NM AS BEFORE_PA_OPT_TYP_CD
               ,I.FULL_PATH AS BEFORE_PA_SUBJ_PNM
               ,J.PDM_TBL_PNM AS BEFORE_PA_ENTY_PNM
               ,K.PDM_COL_PNM AS BEFORE_PA_ATTR_PNM
               ,L.FULL_PATH AS BEFORE_CH_SUBJ_PNM
               ,M.PDM_TBL_PNM AS BEFORE_CH_ENTY_PNM
               ,N.PDM_COL_PNM AS BEFORE_CH_ATTR_PNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_PDM_REL A
               LEFT OUTER JOIN WAM_PDM_REL B
                 ON A.PDM_REL_PNM = B.PDM_REL_PNM
                AND A.CH_SUBJ_PNM = ( SELECT FULL_PATH
			   						   FROM WAA_SUBJ
			   						  WHERE SUBJ_ID = B.CH_SUBJ_ID
			   						    AND REG_TYP_CD IN ('C', 'U')
			   						    AND EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')  
			   					    )
				AND A.CH_ENTY_PNM = ( SELECT PDM_TBL_PNM
			   					 	   FROM WAM_PDM_TBL
			   					 	  WHERE PDM_TBL_ID = B.CH_ENTY_ID
			   					 	    AND REG_TYP_CD IN ('C', 'U')
			   					    )
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'REL_TYP_CD'
                                ) C
            ON A.REL_TYP_CD = C.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CRD_TYP_CD'
                                ) D
            ON A.CRD_TYP_CD = D.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'PA_OPT_TYP_CD'
                                ) E
            ON A.PA_OPT_TYP_CD = E.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'REL_TYP_CD'
                                ) F
            ON B.REL_TYP_CD = F.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CRD_TYP_CD'
                                ) G
            ON B.CRD_TYP_CD = G.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'PA_OPT_TYP_CD'
                                ) H
            ON B.PA_OPT_TYP_CD = H.COMM_DTL_CD
          LEFT OUTER JOIN WAA_SUBJ I
          	ON B.PA_SUBJ_ID = I.SUBJ_ID
           AND I.REG_TYP_CD IN ('C', 'U')
           AND I.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
          LEFT OUTER JOIN WAM_PDM_TBL J
            ON B.PA_ENTY_ID = J.PDM_TBL_ID
           AND J.REG_TYP_CD IN ('C', 'U')
          LEFT OUTER JOIN WAM_PDM_COL K
            ON B.PA_ATTR_ID = K.PDM_COL_ID
           AND B.PA_ENTY_ID = K.PDM_TBL_ID
          LEFT OUTER JOIN WAA_SUBJ L
          	ON B.CH_SUBJ_ID = L.SUBJ_ID
           AND L.REG_TYP_CD IN ('C', 'U')
           AND L.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
          LEFT OUTER JOIN WAM_PDM_TBL M
            ON B.CH_ENTY_ID = M.PDM_TBL_ID
           AND M.REG_TYP_CD IN ('C', 'U')
          LEFT OUTER JOIN WAM_PDM_COL N
            ON B.CH_ATTR_ID = N.PDM_COL_ID
           AND B.CH_ENTY_ID = N.PDM_TBL_ID
			   
               
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 12) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectDdlTblChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '테이블논리명'
              WHEN B.NO = 2 THEN '테이블물리명'
              WHEN B.NO = 3 THEN 'DBMS유저명'
              WHEN B.NO = 4 THEN '설명'
              
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_TBL_LNM
              WHEN B.NO = 2 THEN AFTER_DDL_TBL_PNM
              WHEN B.NO = 3 THEN AFTER_DB_SCH_NM
              WHEN B.NO = 4 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_TBL_LNM
              WHEN B.NO = 2 THEN BEFORE_DDL_TBL_PNM
              WHEN B.NO = 3 THEN BEFORE_DB_SCH_NM
              WHEN B.NO = 4 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DDL_TBL_LNM AS AFTER_DDL_TBL_LNM
               ,A.DDL_TBL_PNM AS AFTER_DDL_TBL_PNM
               ,A.DB_USER_PNM AS AFTER_DB_SCH_NM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_TBL_LNM AS BEFORE_DDL_TBL_LNM
               ,B.DDL_TBL_PNM AS BEFORE_DDL_TBL_PNM
               ,C.DB_SCH_LNM AS BEFORE_DB_SCH_NM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_TBL A
               LEFT OUTER JOIN WAM_DDL_TBL B
                 ON A.DDL_TBL_PNM = B.DDL_TBL_PNM
			   LEFT OUTER JOIN  WAA_DB_SCH C
                 ON B.DB_SCH_ID = C.DB_SCH_ID
                AND C.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND C.REG_TYP_CD IN ('C', 'U')
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 4) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectDdlColChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '컬럼논리명'
              WHEN B.NO = 2 THEN '컬럼물리명'
              WHEN B.NO = 3 THEN '컬럼순서'
              WHEN B.NO = 4 THEN '데이터타입'
              WHEN B.NO = 5 THEN '데이터길이'     
              WHEN B.NO = 6 THEN '데이터소수점길이'
              WHEN B.NO = 7 THEN 'PK여부'
              WHEN B.NO = 8 THEN 'PK순서'
              WHEN B.NO = 9 THEN 'NOTNULL여부'
              WHEN B.NO = 10 THEN 'DEFAULT값'
              WHEN B.NO = 11 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_COL_LNM
              WHEN B.NO = 2 THEN AFTER_DDL_COL_PNM
              WHEN B.NO = 3 THEN TO_CHAR(AFTER_COL_ORD)
              WHEN B.NO = 4 THEN AFTER_DATA_TYPE
              WHEN B.NO = 5 THEN TO_CHAR(AFTER_DATA_LEN)
              WHEN B.NO = 6 THEN TO_CHAR(AFTER_DATA_SCAL)
              WHEN B.NO = 7 THEN AFTER_PK_YN
              WHEN B.NO = 8 THEN TO_CHAR(AFTER_PK_ORD)
              WHEN B.NO = 9 THEN AFTER_NONUL_YN
              WHEN B.NO = 10 THEN AFTER_DEFLT_VAL
              WHEN B.NO = 11 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_COL_LNM
              WHEN B.NO = 2 THEN BEFORE_DDL_COL_PNM
              WHEN B.NO = 3 THEN TO_CHAR(BEFORE_COL_ORD)
              WHEN B.NO = 4 THEN BEFORE_DATA_TYPE
              WHEN B.NO = 5 THEN TO_CHAR(BEFORE_DATA_LEN)
              WHEN B.NO = 6 THEN TO_CHAR(BEFORE_DATA_SCAL)
              WHEN B.NO = 7 THEN BEFORE_PK_YN
              WHEN B.NO = 8 THEN TO_CHAR(BEFORE_PK_ORD)
              WHEN B.NO = 9 THEN BEFORE_NONUL_YN
              WHEN B.NO = 10 THEN BEFORE_DEFLT_VAL
              WHEN B.NO = 11 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.DDL_COL_LNM AS AFTER_DDL_COL_LNM
               ,A.DDL_COL_PNM AS AFTER_DDL_COL_PNM
               ,A.COL_ORD AS AFTER_COL_ORD
               ,A.DATA_TYPE AS AFTER_DATA_TYPE
               ,A.DATA_LEN AS AFTER_DATA_LEN
               ,A.DATA_SCAL AS AFTER_DATA_SCAL
               ,CASE WHEN A.PK_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.PK_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_PK_YN
               ,A.PK_ORD AS AFTER_PK_ORD
               ,CASE WHEN A.NONUL_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.NONUL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_NONUL_YN
               ,A.DEFLT_VAL AS AFTER_DEFLT_VAL
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_COL_LNM AS BEFORE_DDL_COL_LNM
               ,B.DDL_COL_PNM AS BEFORE_DDL_COL_PNM
               ,B.COL_ORD AS BEFORE_COL_ORD
               ,B.DATA_TYPE AS BEFORE_DATA_TYPE
               ,B.DATA_LEN AS BEFORE_DATA_LEN
               ,B.DATA_SCAL AS BEFORE_DATA_SCAL
               ,CASE WHEN B.PK_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.PK_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_PK_YN
               ,B.PK_ORD AS BEFORE_PK_ORD
               ,CASE WHEN B.NONUL_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.NONUL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_NONUL_YN
               ,B.DEFLT_VAL AS BEFORE_DEFLT_VAL
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_COL A
               LEFT OUTER JOIN (SELECT A.*
		                                       ,B.DDL_TBL_PNM
		                                  FROM WAM_DDL_COL A
		                                       INNER JOIN WAM_DDL_TBL B
		                                          ON A.DDL_TBL_ID = B.DDL_TBL_ID
		                                         AND A.REG_TYP_CD IN ('C','U')
		                                         AND B.REG_TYP_CD IN ('C','U')
		                                WHERE B.DDL_TBL_PNM = #{searchObj,jdbcType=VARCHAR}  ) B
                 ON A.DDL_TBL_PNM = B.DDL_TBL_PNM
                AND A.DDL_COL_PNM = B.DDL_COL_PNM                                         
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 11) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectTblMapChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '타겟테이블논리명'
              WHEN B.NO = 2 THEN '타겟테이블물리명'
              WHEN B.NO = 3 THEN '타겟DB명'
              WHEN B.NO = 4 THEN '매핑일련번호'
              WHEN B.NO = 5 THEN '테이블매핑타입'
              WHEN B.NO = 6 THEN '타겟주제영역명'     
              WHEN B.NO = 7 THEN '타겟이행타입'
              WHEN B.NO = 8 THEN '소스업무명'
              WHEN B.NO = 9 THEN '소스시스템명'
              WHEN B.NO = 10 THEN '소스DB명'
              WHEN B.NO = 11 THEN '소스테이블논리명'
              WHEN B.NO = 12 THEN '소스테이블물리명'
              WHEN B.NO = 13 THEN '선택스킵조건명'
              WHEN B.NO = 14 THEN '조인조건명'
              WHEN B.NO = 15 THEN '응용담당자명'
              WHEN B.NO = 16 THEN '전환담당자명'
              WHEN B.NO = 17 THEN '참조설명'
              WHEN B.NO = 18 THEN '사전이행설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_TGT_TBL_LNM
              WHEN B.NO = 2 THEN AFTER_TGT_TBL_PNM
              WHEN B.NO = 3 THEN AFTER_TGT_DB_PNM
              WHEN B.NO = 4 THEN AFTER_MAP_SNO
              WHEN B.NO = 5 THEN AFTER_TBL_MAP_TYPE
              WHEN B.NO = 6 THEN AFTER_TGT_SUBJ_ALL_PATH
              WHEN B.NO = 7 THEN AFTER_TGT_FLF_TYPE
              WHEN B.NO = 8 THEN AFTER_SRC_BIZ_NM
              WHEN B.NO = 9 THEN AFTER_SRC_SYS_NM
              WHEN B.NO = 10 THEN AFTER_SRC_DB_PNM
              WHEN B.NO = 11 THEN AFTER_SRC_TBL_LNM
              WHEN B.NO = 12 THEN AFTER_SRC_TBL_PNM
              WHEN B.NO = 13 THEN AFTER_SLT_SKP_CND_NM
              WHEN B.NO = 14 THEN AFTER_JN_CND_NM
              WHEN B.NO = 15 THEN AFTER_APP_CRGP_NM
              WHEN B.NO = 16 THEN AFTER_CNVS_CRGP_NM
              WHEN B.NO = 17 THEN AFTER_REF_DESCN
              WHEN B.NO = 18 THEN AFTER_PRE_FLF_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_TGT_TBL_LNM
              WHEN B.NO = 2 THEN BEFORE_TGT_TBL_PNM
              WHEN B.NO = 3 THEN BEFORE_TGT_DB_PNM
              WHEN B.NO = 4 THEN BEFORE_MAP_SNO
              WHEN B.NO = 5 THEN BEFORE_TBL_MAP_TYPE
              WHEN B.NO = 6 THEN BEFORE_TGT_SUBJ_ALL_PATH
              WHEN B.NO = 7 THEN BEFORE_TGT_FLF_TYPE
              WHEN B.NO = 8 THEN BEFORE_SRC_BIZ_NM
              WHEN B.NO = 9 THEN BEFORE_SRC_SYS_NM
              WHEN B.NO = 10 THEN BEFORE_SRC_DB_PNM
              WHEN B.NO = 11 THEN BEFORE_SRC_TBL_LNM
              WHEN B.NO = 12 THEN BEFORE_SRC_TBL_PNM
              WHEN B.NO = 13 THEN BEFORE_SLT_SKP_CND_NM
              WHEN B.NO = 14 THEN BEFORE_JN_CND_NM
              WHEN B.NO = 15 THEN BEFORE_APP_CRGP_NM
              WHEN B.NO = 16 THEN BEFORE_CNVS_CRGP_NM
              WHEN B.NO = 17 THEN BEFORE_REF_DESCN
              WHEN B.NO = 18 THEN BEFORE_PRE_FLF_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.TGT_TBL_LNM AS AFTER_TGT_TBL_LNM
               ,A.TGT_TBL_PNM AS AFTER_TGT_TBL_PNM
               ,A.TGT_DB_PNM AS AFTER_TGT_DB_PNM
               ,A.MAP_SNO AS AFTER_MAP_SNO
               ,C.COMM_DTL_CD_NM AS AFTER_TBL_MAP_TYPE
               ,A.TGT_SUBJ_ALL_PATH AS AFTER_TGT_SUBJ_ALL_PATH
               ,D.COMM_DTL_CD_NM AS AFTER_TGT_FLF_TYPE
               ,A.SRC_BIZ_NM AS AFTER_SRC_BIZ_NM
               ,A.SRC_SYS_NM AS AFTER_SRC_SYS_NM
               ,A.SRC_DB_PNM AS AFTER_SRC_DB_PNM
               ,A.SRC_TBL_LNM AS AFTER_SRC_TBL_LNM
               ,A.SRC_TBL_PNM AS AFTER_SRC_TBL_PNM
               ,A.SLT_SKP_CND_NM AS AFTER_SLT_SKP_CND_NM
               ,A.JN_CND_NM AS AFTER_JN_CND_NM
               ,A.APP_CRGP_NM AS AFTER_APP_CRGP_NM
               ,A.CNVS_CRGP_NM AS AFTER_CNVS_CRGP_NM
               ,A.REF_DESCN AS AFTER_REF_DESCN
               ,A.PRE_FLF_DESCN AS AFTER_PRE_FLF_DESCN
               ,B.TGT_TBL_LNM AS BEFORE_TGT_TBL_LNM
               ,B.TGT_TBL_PNM AS BEFORE_TGT_TBL_PNM
               ,B.TGT_DB_PNM AS BEFORE_TGT_DB_PNM
               ,B.MAP_SNO AS BEFORE_MAP_SNO
               ,E.COMM_DTL_CD_NM AS BEFORE_TBL_MAP_TYPE
               ,B.TGT_SUBJ_ALL_PATH AS BEFORE_TGT_SUBJ_ALL_PATH
               ,F.COMM_DTL_CD_NM AS BEFORE_TGT_FLF_TYPE
               ,B.SRC_BIZ_NM AS BEFORE_SRC_BIZ_NM
               ,B.SRC_SYS_NM AS BEFORE_SRC_SYS_NM
               ,B.SRC_DB_PNM AS BEFORE_SRC_DB_PNM
               ,B.SRC_TBL_LNM AS BEFORE_SRC_TBL_LNM
               ,B.SRC_TBL_PNM AS BEFORE_SRC_TBL_PNM
               ,B.SLT_SKP_CND_NM AS BEFORE_SLT_SKP_CND_NM
               ,B.JN_CND_NM AS BEFORE_JN_CND_NM
               ,B.APP_CRGP_NM AS BEFORE_APP_CRGP_NM
               ,B.CNVS_CRGP_NM AS BEFORE_CNVS_CRGP_NM
               ,B.REF_DESCN AS BEFORE_REF_DESCN
               ,B.PRE_FLF_DESCN AS BEFORE_PRE_FLF_DESCN
          FROM WAQ_TBL_MAP A
               LEFT OUTER JOIN WAM_TBL_MAP B
                 ON A.TBL_MAP_ID = B.TBL_MAP_ID
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'TBL_MAP_TYP_CD'
                                ) C
                 ON A.TBL_MAP_TYPE = C.COMM_DTL_CD 
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'TGT_FLF_TYP_CD'
                                ) D 
                 ON A.TGT_FLF_TYPE = D.COMM_DTL_CD 
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'TBL_MAP_TYP_CD'
                                ) E
                 ON B.TBL_MAP_TYPE = E.COMM_DTL_CD 
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'TGT_FLF_TYP_CD'
                                ) F 
                 ON B.TGT_FLF_TYPE = F.COMM_DTL_CD 
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 18) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectCodMapChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE          
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>     
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '매핑정의서유형'
              WHEN B.NO = 2 THEN '코드전환유형'
              WHEN B.NO = 3 THEN '코드매핑유형'
              WHEN B.NO = 4 THEN '타겟(TOBE)코드도메인명'
              WHEN B.NO = 5 THEN '타겟(TOBE) 코드값'
              WHEN B.NO = 6 THEN '타겟(TOBE) 코드명'     
              WHEN B.NO = 7 THEN '소스(ASIS)시스템명'
              WHEN B.NO = 8 THEN '소스(ASIS)업무명'
              WHEN B.NO = 9 THEN '소스(ASIS)DB명'
              WHEN B.NO = 10 THEN '소스(ASIS)테이블물리명'
              WHEN B.NO = 11 THEN '소스(ASIS)테이블논리명'
              WHEN B.NO = 12 THEN '소스(ASIS)컬럼물리명'
              WHEN B.NO = 13 THEN '소스(ASIS)컬럼논리명'
              WHEN B.NO = 14 THEN '소스(ASIS) 코드'
              WHEN B.NO = 15 THEN '소스(ASIS) 코드명'
              WHEN B.NO = 16 THEN '소스(ASIS) 상위코드'
              WHEN B.NO = 17 THEN '소스(ASIS) 상위코드명'
              WHEN B.NO = 18 THEN '응용담당자'
              WHEN B.NO = 19 THEN '전환담당자'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_MAP_DF_TYPE
              WHEN B.NO = 2 THEN AFTER_CD_CNVS_TYPE
              WHEN B.NO = 3 THEN AFTER_CD_MAP_TYPE
              WHEN B.NO = 4 THEN AFTER_TGT_DMN_LNM
              WHEN B.NO = 5 THEN AFTER_TGT_CD_VAL
              WHEN B.NO = 6 THEN AFTER_TGT_CD_VAL_NM
              WHEN B.NO = 7 THEN AFTER_SRC_SYS_NM
              WHEN B.NO = 8 THEN AFTER_SRC_BIZ_NM
              WHEN B.NO = 9 THEN AFTER_SRC_DB_PNM
              WHEN B.NO = 10 THEN AFTER_SRC_TBL_PNM
              WHEN B.NO = 11 THEN AFTER_SRC_TBL_LNM
              WHEN B.NO = 12 THEN AFTER_SRC_COL_PNM
              WHEN B.NO = 13 THEN AFTER_SRC_COL_LNM              
              WHEN B.NO = 14 THEN AFTER_SRC_CD_VAL
              WHEN B.NO = 15 THEN AFTER_SRC_CD_VAL_NM
              WHEN B.NO = 16 THEN AFTER_SRC_UPP_CD_VAL
              WHEN B.NO = 17 THEN AFTER_SRC_UPP_CD_VAL_NM
              WHEN B.NO = 18 THEN AFTER_APP_CRGP_NM
              WHEN B.NO = 19 THEN AFTER_CNVS_CRGP_NM
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_MAP_DF_TYPE
              WHEN B.NO = 2 THEN BEFORE_CD_CNVS_TYPE
              WHEN B.NO = 3 THEN BEFORE_CD_MAP_TYPE
              WHEN B.NO = 4 THEN BEFORE_TGT_DMN_LNM
              WHEN B.NO = 5 THEN BEFORE_TGT_CD_VAL
              WHEN B.NO = 6 THEN BEFORE_TGT_CD_VAL_NM
              WHEN B.NO = 7 THEN BEFORE_SRC_SYS_NM
              WHEN B.NO = 8 THEN BEFORE_SRC_BIZ_NM
              WHEN B.NO = 9 THEN BEFORE_SRC_DB_PNM
              WHEN B.NO = 10 THEN BEFORE_SRC_TBL_PNM
              WHEN B.NO = 11 THEN BEFORE_SRC_TBL_LNM
              WHEN B.NO = 12 THEN BEFORE_SRC_COL_PNM
              WHEN B.NO = 13 THEN BEFORE_SRC_COL_LNM              
              WHEN B.NO = 14 THEN BEFORE_SRC_CD_VAL
              WHEN B.NO = 15 THEN BEFORE_SRC_CD_VAL_NM
              WHEN B.NO = 16 THEN BEFORE_SRC_UPP_CD_VAL
              WHEN B.NO = 17 THEN BEFORE_SRC_UPP_CD_VAL_NM
              WHEN B.NO = 18 THEN BEFORE_APP_CRGP_NM
              WHEN B.NO = 19 THEN BEFORE_CNVS_CRGP_NM
         ELSE NULL END) AS BEFORE  

from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,GET_CMCD_DTL_NM('MAP_DF_TYP_CD', A.MAP_DF_TYPE) AS AFTER_MAP_DF_TYPE
               ,GET_CMCD_DTL_NM('CD_CNVS_TYPE', A.CD_CNVS_TYPE) AS AFTER_CD_CNVS_TYPE
               ,GET_CMCD_DTL_NM('CD_MAP_TYPE', A.CD_MAP_TYPE) AS AFTER_CD_MAP_TYPE
               ,A.TGT_DMN_LNM       AS  AFTER_TGT_DMN_LNM      
               ,A.TGT_CD_VAL        AS  AFTER_TGT_CD_VAL       
               ,A.TGT_CD_VAL_NM     AS  AFTER_TGT_CD_VAL_NM    
               ,A.SRC_SYS_NM        AS  AFTER_SRC_SYS_NM       
               ,A.SRC_BIZ_NM        AS  AFTER_SRC_BIZ_NM       
               ,A.SRC_DB_PNM        AS  AFTER_SRC_DB_PNM       
               ,A.SRC_TBL_PNM       AS  AFTER_SRC_TBL_PNM      
               ,A.SRC_TBL_LNM       AS  AFTER_SRC_TBL_LNM      
               ,A.SRC_COL_PNM       AS  AFTER_SRC_COL_PNM      
               ,A.SRC_COL_LNM       AS  AFTER_SRC_COL_LNM                     
               ,A.SRC_CD_VAL        AS  AFTER_SRC_CD_VAL       
               ,A.SRC_CD_VAL_NM     AS  AFTER_SRC_CD_VAL_NM    
               ,A.SRC_UPP_CD_VAL    AS  AFTER_SRC_UPP_CD_VAL   
               ,A.SRC_UPP_CD_VAL_NM AS  AFTER_SRC_UPP_CD_VAL_NM
               ,A.APP_CRGP_NM AS  AFTER_APP_CRGP_NM
               ,A.CNVS_CRGP_NM AS  AFTER_CNVS_CRGP_NM
               ,B.TGT_DMN_LNM       AS  BEFORE_TGT_DMN_LNM      
               ,B.TGT_CD_VAL        AS  BEFORE_TGT_CD_VAL       
               ,B.TGT_CD_VAL_NM     AS  BEFORE_TGT_CD_VAL_NM    
               ,B.SRC_SYS_NM        AS  BEFORE_SRC_SYS_NM       
               ,B.SRC_BIZ_NM        AS  BEFORE_SRC_BIZ_NM       
               ,B.SRC_DB_PNM        AS  BEFORE_SRC_DB_PNM       
               ,B.SRC_TBL_PNM       AS  BEFORE_SRC_TBL_PNM      
               ,B.SRC_TBL_LNM       AS  BEFORE_SRC_TBL_LNM      
               ,B.SRC_COL_PNM       AS  BEFORE_SRC_COL_PNM      
               ,B.SRC_COL_LNM       AS  BEFORE_SRC_COL_LNM      
               ,B.SRC_CD_VAL        AS  BEFORE_SRC_CD_VAL       
               ,B.SRC_CD_VAL_NM     AS  BEFORE_SRC_CD_VAL_NM    
               ,B.SRC_UPP_CD_VAL    AS  BEFORE_SRC_UPP_CD_VAL   
               ,B.SRC_UPP_CD_VAL_NM AS  BEFORE_SRC_UPP_CD_VAL_NM
               ,GET_CMCD_DTL_NM('MAP_DF_TYP_CD', B.MAP_DF_TYPE) AS BEFORE_MAP_DF_TYPE
               ,GET_CMCD_DTL_NM('CD_CNVS_TYPE', B.CD_CNVS_TYPE) AS BEFORE_CD_CNVS_TYPE
               ,GET_CMCD_DTL_NM('CD_MAP_TYPE', B.CD_MAP_TYPE) AS BEFORE_CD_MAP_TYPE
               ,B.APP_CRGP_NM AS  BEFORE_APP_CRGP_NM
               ,B.CNVS_CRGP_NM AS  BEFORE_CNVS_CRGP_NM
          FROM WAQ_COD_MAP A
               LEFT OUTER JOIN WAM_COD_MAP B
                 ON A.CD_MAP_ID = B.CD_MAP_ID
        WHERE A.RQST_NO = 'REQ_00000005865'
          AND A.RQST_SNO = 1
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 19) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectBizAreaChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '업무영역명'
              WHEN B.NO = 2 THEN '상위업무영역명'
              WHEN B.NO = 3 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_BIZ_AREA_LNM
              WHEN B.NO = 2 THEN AFTER_UPP_BIZ_AREA_LNM
              WHEN B.NO = 3 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_BIZ_AREA_LNM
              WHEN B.NO = 2 THEN BEFORE_UPP_BIZ_AREA_LNM
              WHEN B.NO = 3 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.BIZ_AREA_LNM AS AFTER_BIZ_AREA_LNM
               ,C.BIZ_AREA_LNM AS AFTER_UPP_BIZ_AREA_LNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.BIZ_AREA_LNM AS BEFORE_BIZ_AREA_LNM
               ,D.BIZ_AREA_LNM AS BEFORE_UPP_BIZ_AREA_LNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_BIZ_AREA A
               LEFT OUTER JOIN WAM_BIZ_AREA B
                 ON A.BIZ_AREA_ID = B.BIZ_AREA_ID
			   LEFT OUTER JOIN (SELECT BIZ_AREA_ID, BIZ_AREA_LNM
			    				  FROM WAM_BIZ_AREA
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) C
                 ON A.UPP_BIZ_AREA_ID = C.BIZ_AREA_ID
               LEFT OUTER JOIN (SELECT BIZ_AREA_ID, BIZ_AREA_LNM
			    				  FROM WAM_BIZ_AREA
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON B.UPP_BIZ_AREA_ID = D.BIZ_AREA_ID 
			   
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 3) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectDqiChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '데이터품질지표명'
              WHEN B.NO = 2 THEN '상위데이터품질지표명'
              WHEN B.NO = 3 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DQI_LNM
              WHEN B.NO = 2 THEN AFTER_UPP_DQI_LNM
              WHEN B.NO = 3 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DQI_LNM
              WHEN B.NO = 2 THEN BEFORE_UPP_DQI_LNM
              WHEN B.NO = 3 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DQI_LNM AS AFTER_DQI_LNM
               ,C.DQI_LNM AS AFTER_UPP_DQI_LNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DQI_LNM AS BEFORE_DQI_LNM
               ,D.DQI_LNM AS BEFORE_UPP_DQI_LNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DQI A
               LEFT OUTER JOIN WAM_DQI B
                 ON A.DQI_ID = B.DQI_ID
			   LEFT OUTER JOIN (SELECT DQI_ID, DQI_LNM
			    				  FROM WAM_DQI
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) C
                 ON A.UPP_DQI_ID = C.DQI_ID
               LEFT OUTER JOIN (SELECT DQI_ID, DQI_LNM
			    				  FROM WAM_DQI
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON B.UPP_DQI_ID = D.DQI_ID 
			   
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 3) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectCtqChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '중요정보항목명'
              WHEN B.NO = 2 THEN '상위중요정보항목명'
              WHEN B.NO = 3 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_CTQ_LNM
              WHEN B.NO = 2 THEN AFTER_UPP_CTQ_LNM
              WHEN B.NO = 3 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_CTQ_LNM
              WHEN B.NO = 2 THEN BEFORE_UPP_CTQ_LNM
              WHEN B.NO = 3 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.CTQ_LNM AS AFTER_CTQ_LNM
               ,C.CTQ_LNM AS AFTER_UPP_CTQ_LNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.CTQ_LNM AS BEFORE_CTQ_LNM
               ,D.CTQ_LNM AS BEFORE_UPP_CTQ_LNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_CTQ A
               LEFT OUTER JOIN WAM_CTQ B
                 ON A.CTQ_ID = B.CTQ_ID
			   LEFT OUTER JOIN (SELECT CTQ_ID, CTQ_LNM
			    				  FROM WAM_CTQ
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) C
                 ON A.UPP_CTQ_ID = C.CTQ_ID
               LEFT OUTER JOIN (SELECT CTQ_ID, CTQ_LNM
			    				  FROM WAM_CTQ
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON B.UPP_CTQ_ID = D.CTQ_ID 
			   
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 3) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectBizruleChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '업무규칙명'
              WHEN B.NO = 2 THEN '업무규칙담당자'
              WHEN B.NO = 3 THEN '사용여부'
              WHEN B.NO = 4 THEN '업무영역명'
              WHEN B.NO = 5 THEN '데이터품질지표명'
              WHEN B.NO = 6 THEN '중요정보항목명'
              WHEN B.NO = 7 THEN 'DB접속대상명'
              WHEN B.NO = 8 THEN '테이블명'
              WHEN B.NO = 9 THEN '컬럼명'
              WHEN B.NO = 10 THEN '타겟DB접속대상명'
              WHEN B.NO = 11 THEN '타겟테이블명'
              WHEN B.NO = 12 THEN '타겟컬럼명'
              WHEN B.NO = 13 THEN '타겟키컬럼명'
              WHEN B.NO = 14 THEN '타겟키컬럼값'
              WHEN B.NO = 15 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_BR_NM
              WHEN B.NO = 2 THEN AFTER_BR_CRGP_USER_NM
              WHEN B.NO = 3 THEN AFTER_USE_YN
              WHEN B.NO = 4 THEN AFTER_BIZ_AREA_LNM
              WHEN B.NO = 5 THEN AFTER_DQI_LNM
              WHEN B.NO = 6 THEN AFTER_CTQ_LNM
              WHEN B.NO = 7 THEN AFTER_DB_CONN_TRG_PNM
              WHEN B.NO = 8 THEN AFTER_DBC_TBL_NM
              WHEN B.NO = 9 THEN AFTER_DBC_COL_NM
              WHEN B.NO = 10 THEN AFTER_TGT_DB_CONN_TRG_PNM
              WHEN B.NO = 11 THEN AFTER_TGT_DBC_TBL_NM
              WHEN B.NO = 12 THEN AFTER_TGT_DBC_COL_NM
              WHEN B.NO = 13 THEN AFTER_TGT_KEY_DBC_COL_NM
              WHEN B.NO = 14 THEN AFTER_TGT_KEY_DBC_COL_VAL
              WHEN B.NO = 15 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_BR_NM
              WHEN B.NO = 2 THEN BEFORE_BR_CRGP_USER_NM
              WHEN B.NO = 3 THEN BEFORE_USE_YN
              WHEN B.NO = 4 THEN BEFORE_BIZ_AREA_LNM
              WHEN B.NO = 5 THEN BEFORE_DQI_LNM
              WHEN B.NO = 6 THEN BEFORE_CTQ_LNM
              WHEN B.NO = 7 THEN BEFORE_DB_CONN_TRG_PNM
              WHEN B.NO = 8 THEN BEFORE_DBC_TBL_NM
              WHEN B.NO = 9 THEN BEFORE_DBC_COL_NM
              WHEN B.NO = 10 THEN BEFORE_TGT_DB_CONN_TRG_PNM
              WHEN B.NO = 11 THEN BEFORE_TGT_DBC_TBL_NM
              WHEN B.NO = 12 THEN BEFORE_TGT_DBC_COL_NM
              WHEN B.NO = 13 THEN BEFORE_TGT_KEY_DBC_COL_NM
              WHEN B.NO = 14 THEN BEFORE_TGT_KEY_DBC_COL_VAL
              WHEN B.NO = 15 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.BR_NM AS AFTER_BR_NM
               ,C.USER_NM AS AFTER_BR_CRGP_USER_NM
               ,CASE WHEN A.USE_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.USE_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_USE_YN
               ,A.BIZ_AREA_LNM AS AFTER_BIZ_AREA_LNM
               ,D.DQI_LNM AS AFTER_DQI_LNM
               ,E.CTQ_LNM AS AFTER_CTQ_LNM
               ,A.DB_CONN_TRG_PNM AS AFTER_DB_CONN_TRG_PNM
               ,A.DBC_TBL_NM AS AFTER_DBC_TBL_NM
               ,A.DBC_COL_NM AS AFTER_DBC_COL_NM
               ,A.TGT_DB_CONN_TRG_PNM AS AFTER_TGT_DB_CONN_TRG_PNM
               ,A.TGT_DBC_TBL_NM AS AFTER_TGT_DBC_TBL_NM
               ,A.TGT_DBC_COL_NM AS AFTER_TGT_DBC_COL_NM
               ,A.TGT_KEY_DBC_COL_NM AS AFTER_TGT_KEY_DBC_COL_NM
               ,A.TGT_KEY_DBC_COL_VAL AS AFTER_TGT_KEY_DBC_COL_VAL
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
			   ,B.BR_NM AS BEFORE_BR_NM
               ,F.USER_NM AS BEFORE_BR_CRGP_USER_NM
               ,CASE WHEN B.USE_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.USE_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_USE_YN
               ,N.FULL_PATH AS BEFORE_BIZ_AREA_LNM
               ,H.FULL_PATH AS BEFORE_DQI_LNM
               ,J.FULL_PATH AS BEFORE_CTQ_LNM
               ,K.DB_CONN_TRG_PNM AS BEFORE_DB_CONN_TRG_PNM
               ,B.DBC_TBL_NM AS BEFORE_DBC_TBL_NM
               ,B.DBC_COL_NM AS BEFORE_DBC_COL_NM
               ,L.DB_CONN_TRG_PNM AS BEFORE_TGT_DB_CONN_TRG_PNM
               ,B.TGT_DBC_TBL_NM AS BEFORE_TGT_DBC_TBL_NM
               ,B.TGT_DBC_COL_NM AS BEFORE_TGT_DBC_COL_NM
               ,B.TGT_KEY_DBC_COL_NM AS BEFORE_TGT_KEY_DBC_COL_NM
               ,B.TGT_KEY_DBC_COL_VAL AS BEFORE_TGT_KEY_DBC_COL_VAL
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_BR_MSTR A
               LEFT OUTER JOIN WAM_BR_MSTR B
                 ON A.BR_NM = B.BR_NM
               LEFT OUTER JOIN (SELECT USER_ID, USER_NM
               					  FROM WAA_USER
               					 WHERE REG_TYP_CD IN ('C', 'U')
               					   AND EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
               				   ) C
                 ON A.BR_CRGP_USER_ID = C.USER_ID
			   LEFT OUTER JOIN (SELECT DQI_ID, DQI_LNM, RQST_NO, RQST_SNO
			    				  FROM WAQ_BR_DQI_MAP
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON A.RQST_NO = D.RQST_NO
                AND A.RQST_SNO = D.RQST_SNO
               LEFT OUTER JOIN (SELECT CTQ_ID, CTQ_LNM, RQST_NO, RQST_SNO
			    				  FROM WAQ_BR_CTQ_MAP
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) E
                 ON A.RQST_NO = E.RQST_NO
                AND A.RQST_SNO = E.RQST_SNO
			   LEFT OUTER JOIN (SELECT USER_ID, USER_NM
               					  FROM WAA_USER
               					 WHERE REG_TYP_CD IN ('C', 'U')
               					   AND EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
               				   ) F
                 ON B.BR_CRGP_USER_ID = F.USER_ID
               LEFT OUTER JOIN (SELECT BR_ID, DQI_ID
                                  FROM WAM_BR_DQI_MAP
                                 WHERE REG_TYP_CD IN ('C', 'U')
                               ) G
                 ON B.BR_ID = G.BR_ID
               LEFT OUTER JOIN (SELECT DQI_ID, DQI_LNM, FULL_PATH
               					  FROM WAM_DQI
               					 WHERE REG_TYP_CD IN ('C', 'U')
               				   ) H
                 ON G.DQI_ID = H.DQI_ID
               LEFT OUTER JOIN (SELECT BR_ID, CTQ_ID
                                  FROM WAM_BR_CTQ_MAP
                                 WHERE REG_TYP_CD IN ('C', 'U')
                               ) I
                 ON B.BR_ID = I.BR_ID
               LEFT OUTER JOIN (SELECT CTQ_ID, CTQ_LNM, FULL_PATH
               					  FROM WAM_CTQ
               					 WHERE REG_TYP_CD IN ('C', 'U')
               				   ) J
                 ON I.CTQ_ID = J.CTQ_ID
               LEFT OUTER JOIN (SELECT DB_CONN_TRG_ID, DB_CONN_TRG_PNM
               					  FROM WAA_DB_CONN_TRG
               					 WHERE REG_TYP_CD IN ('C', 'U')
               					   AND EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
               				   ) K
               	 ON B.DB_CONN_TRG_ID = K.DB_CONN_TRG_ID 
               LEFT OUTER JOIN (SELECT DB_CONN_TRG_ID, DB_CONN_TRG_PNM
               					  FROM WAA_DB_CONN_TRG
               					 WHERE REG_TYP_CD IN ('C', 'U')
               					   AND EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
               				   ) L
               	 ON B.TGT_DB_CONN_TRG_ID = L.DB_CONN_TRG_ID 
               LEFT OUTER JOIN (SELECT BIZ_AREA_ID, BIZ_AREA_LNM, FULL_PATH
               					  FROM WAM_BIZ_AREA
               					 WHERE REG_TYP_CD IN ('C', 'U')
               				   ) N
               	 ON B.BIZ_AREA_ID = N.BIZ_AREA_ID
                            
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 15) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectImPlChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '원인분석코드명'
              WHEN B.NO = 2 THEN '원인분석내역'
              WHEN B.NO = 3 THEN '원인분석시작일자'
              WHEN B.NO = 4 THEN '원인분석종료일자'
              WHEN B.NO = 5 THEN '개선계획코드명'
              WHEN B.NO = 6 THEN '개선계획내역'
              WHEN B.NO = 7 THEN '개선계획시작일자'
              WHEN B.NO = 8 THEN '개선계획종료일자'
              WHEN B.NO = 9 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_CS_ANA_CD_NM
              WHEN B.NO = 2 THEN AFTER_CS_ANA_DTLS
              WHEN B.NO = 3 THEN AFTER_CS_ANA_STR_DTM
              WHEN B.NO = 4 THEN AFTER_CS_ANA_END_DTM
              WHEN B.NO = 5 THEN AFTER_IM_PL_CD_NM
              WHEN B.NO = 6 THEN AFTER_IM_PL_DTLS
              WHEN B.NO = 7 THEN AFTER_IM_PL_STR_DTM
              WHEN B.NO = 8 THEN AFTER_IM_PL_END_DTM
              WHEN B.NO = 9 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_CS_ANA_CD_NM
              WHEN B.NO = 2 THEN BEFORE_CS_ANA_DTLS
              WHEN B.NO = 3 THEN BEFORE_CS_ANA_STR_DTM
              WHEN B.NO = 4 THEN BEFORE_CS_ANA_END_DTM
              WHEN B.NO = 5 THEN BEFORE_IM_PL_CD_NM
              WHEN B.NO = 6 THEN BEFORE_IM_PL_DTLS
              WHEN B.NO = 7 THEN BEFORE_IM_PL_STR_DTM
              WHEN B.NO = 8 THEN BEFORE_IM_PL_END_DTM
              WHEN B.NO = 9 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.CS_ANA_CD_NM AS AFTER_CS_ANA_CD_NM
               ,A.CS_ANA_DTLS AS AFTER_CS_ANA_DTLS
               ,TO_CHAR(TO_DATE(A.CS_ANA_STR_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS AFTER_CS_ANA_STR_DTM
               ,TO_CHAR(TO_DATE(A.CS_ANA_END_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS AFTER_CS_ANA_END_DTM
               ,A.IM_PL_CD_NM AS AFTER_IM_PL_CD_NM
               ,A.IM_PL_DTLS AS AFTER_IM_PL_DTLS
               ,TO_CHAR(TO_DATE(A.IM_PL_STR_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS AFTER_IM_PL_STR_DTM
               ,TO_CHAR(TO_DATE(A.IM_PL_END_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS AFTER_IM_PL_END_DTM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
			   ,B.CS_ANA_CD_NM AS BEFORE_CS_ANA_CD_NM
               ,B.CS_ANA_DTLS AS BEFORE_CS_ANA_DTLS
               ,TO_CHAR(TO_DATE(A.CS_ANA_STR_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS BEFORE_CS_ANA_STR_DTM
               ,TO_CHAR(TO_DATE(A.CS_ANA_END_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS BEFORE_CS_ANA_END_DTM
               ,B.IM_PL_CD_NM AS BEFORE_IM_PL_CD_NM
               ,B.IM_PL_DTLS AS BEFORE_IM_PL_DTLS
               ,TO_CHAR(TO_DATE(B.IM_PL_STR_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS BEFORE_IM_PL_STR_DTM
               ,TO_CHAR(TO_DATE(B.IM_PL_END_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS BEFORE_IM_PL_END_DTM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_CS_ANA_MSTR A
               LEFT OUTER JOIN WAM_CS_ANA_MSTR B
                 ON A.ANA_JOB_ID = B.ANA_JOB_ID
                AND A.ANA_STR_DTM = B.ANA_STR_DTM
                                           
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 9) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectImRslChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '개선결과코드명'
              WHEN B.NO = 2 THEN '개선결과내역'
              WHEN B.NO = 3 THEN '개선활동시작일자'
              WHEN B.NO = 4 THEN '개선활동종료일자'
              WHEN B.NO = 5 THEN '개선불가코드명'
              WHEN B.NO = 6 THEN '스케줄작업삭제요청여부'
              WHEN B.NO = 7 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_IM_RSL_CD_NM
              WHEN B.NO = 2 THEN AFTER_IM_ACT_DTLS
              WHEN B.NO = 3 THEN AFTER_IM_ACT_STR_DTM
              WHEN B.NO = 4 THEN AFTER_IM_ACT_END_DTM
              WHEN B.NO = 5 THEN AFTER_IM_IL_CD_NM
              WHEN B.NO = 6 THEN AFTER_SHD_JOB_DEL_RQST_YN
              WHEN B.NO = 7 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_IM_RSL_CD_NM
              WHEN B.NO = 2 THEN BEFORE_IM_ACT_DTLS
              WHEN B.NO = 3 THEN BEFORE_IM_ACT_STR_DTM
              WHEN B.NO = 4 THEN BEFORE_IM_ACT_END_DTM
              WHEN B.NO = 5 THEN BEFORE_IM_IL_CD_NM
              WHEN B.NO = 6 THEN BEFORE_SHD_JOB_DEL_RQST_YN
              WHEN B.NO = 7 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.IM_RSL_CD_NM AS AFTER_IM_RSL_CD_NM
               ,A.IM_ACT_DTLS AS AFTER_IM_ACT_DTLS
               ,TO_CHAR(TO_DATE(A.IM_ACT_STR_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS AFTER_IM_ACT_STR_DTM
               ,TO_CHAR(TO_DATE(A.IM_ACT_END_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS AFTER_IM_ACT_END_DTM
               ,A.IM_IL_CD_NM AS AFTER_IM_IL_CD_NM
               ,CASE WHEN A.SHD_JOB_DEL_RQST_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.SHD_JOB_DEL_RQST_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_SHD_JOB_DEL_RQST_YN
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.IM_RSL_CD_NM AS BEFORE_IM_RSL_CD_NM
               ,B.IM_ACT_DTLS AS BEFORE_IM_ACT_DTLS
               ,TO_CHAR(TO_DATE(B.IM_ACT_STR_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS BEFORE_IM_ACT_STR_DTM
               ,TO_CHAR(TO_DATE(B.IM_ACT_END_DTM, 'YYYYMMDD'), 'YYYY-MM-DD') AS BEFORE_IM_ACT_END_DTM
               ,B.IM_IL_CD_NM AS BEFORE_IM_IL_CD_NM
               ,CASE WHEN B.SHD_JOB_DEL_RQST_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.SHD_JOB_DEL_RQST_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_SHD_JOB_DEL_RQST_YN
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
			  
          FROM WAQ_IM_ACT_MSTR A
               LEFT OUTER JOIN WAM_IM_ACT_MSTR B
                 ON A.ANA_JOB_ID = B.ANA_JOB_ID
                AND A.ANA_STR_DTM = B.ANA_STR_DTM
                                           
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 7) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectCodeCfcSysChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '코드분류체계유형'
              WHEN B.NO = 2 THEN '코드분류체계명'
              WHEN B.NO = 3 THEN '코드분류체계포맷'
              WHEN B.NO = 4 THEN '담당자'
              WHEN B.NO = 5 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_CODE_CFC_SYS_CD
              WHEN B.NO = 2 THEN AFTER_CODE_CFC_SYS_LNM
              WHEN B.NO = 3 THEN AFTER_CODE_CFC_SYS_FRM
              WHEN B.NO = 4 THEN AFTER_CRG_USER_NM
              WHEN B.NO = 5 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_CODE_CFC_SYS_CD
              WHEN B.NO = 2 THEN BEFORE_CODE_CFC_SYS_LNM
              WHEN B.NO = 3 THEN BEFORE_CODE_CFC_SYS_FRM
              WHEN B.NO = 4 THEN BEFORE_CRG_USER_NM
              WHEN B.NO = 5 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,C.COMM_DTL_CD_NM AS AFTER_CODE_CFC_SYS_CD
               ,A.CODE_CFC_SYS_LNM AS AFTER_CODE_CFC_SYS_LNM
               ,A.CODE_CFC_SYS_FRM AS AFTER_CODE_CFC_SYS_FRM
			   ,D.USER_NM AS AFTER_CRG_USER_NM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,E.COMM_DTL_CD_NM AS BEFORE_CODE_CFC_SYS_CD
               ,B.CODE_CFC_SYS_LNM AS BEFORE_CODE_CFC_SYS_LNM
               ,B.CODE_CFC_SYS_FRM AS BEFORE_CODE_CFC_SYS_FRM
			   ,F.USER_NM AS BEFORE_CRG_USER_NM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
			  
          FROM WAQ_CODE_CFC_SYS A
               LEFT OUTER JOIN WAM_CODE_CFC_SYS B
                 ON A.CODE_CFC_SYS_CD = B.CODE_CFC_SYS_CD
                AND A.CODE_CFC_SYS_LNM = B.CODE_CFC_SYS_LNM
				AND B.REG_TYP_CD IN ('C', 'U')
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CODE_CFC_SYS_CD'
                                ) C   
                 ON A.CODE_CFC_SYS_CD = C.COMM_DTL_CD    
               LEFT OUTER JOIN (SELECT USER_ID, USER_NM
                                  FROM WAA_USER
                                 WHERE EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                   AND REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON A.CRG_USER_ID = D.USER_ID
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CODE_CFC_SYS_CD'
                                ) E   
                 ON B.CODE_CFC_SYS_CD = E.COMM_DTL_CD   
               LEFT OUTER JOIN (SELECT USER_ID, USER_NM
                                  FROM WAA_USER
                                 WHERE EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                   AND REG_TYP_CD IN ('C', 'U')
                               ) F
                 ON B.CRG_USER_ID = F.USER_ID          
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 5) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectDdlIdxChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '인덱스물리명'
              WHEN B.NO = 2 THEN '인덱스논리명'
              WHEN B.NO = 3 THEN 'DB접속정보명'
              WHEN B.NO = 4 THEN 'DB스키마명'
              WHEN B.NO = 5 THEN 'DDL테이블명'
              WHEN B.NO = 6 THEN '인덱스스페이스명'
              WHEN B.NO = 7 THEN '인덱스유형'
              WHEN B.NO = 8 THEN 'PK여부'
              WHEN B.NO = 9 THEN 'UNIQUE여부'
              WHEN B.NO = 10 THEN '설명'
              
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_IDX_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_IDX_LNM
              WHEN B.NO = 3 THEN AFTER_DB_CONN_TRG_PNM
              WHEN B.NO = 4 THEN AFTER_DB_SCH_PNM
              WHEN B.NO = 5 THEN AFTER_DDL_TBL_PNM
              WHEN B.NO = 6 THEN AFTER_IDX_SPAC_PNM
              WHEN B.NO = 7 THEN AFTER_IDX_TYP_CD
              WHEN B.NO = 8 THEN AFTER_PK_IDX_YN
              WHEN B.NO = 9 THEN AFTER_UK_IDX_YN
              WHEN B.NO = 10 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_IDX_PNM
              WHEN B.NO = 2 THEN BEFORE_DDL_IDX_LNM
              WHEN B.NO = 3 THEN BEFORE_DB_CONN_TRG_PNM
              WHEN B.NO = 4 THEN BEFORE_DB_SCH_PNM
              WHEN B.NO = 5 THEN BEFORE_DDL_TBL_PNM
              WHEN B.NO = 6 THEN BEFORE_IDX_SPAC_PNM
              WHEN B.NO = 7 THEN BEFORE_IDX_TYP_CD
              WHEN B.NO = 8 THEN BEFORE_PK_IDX_YN
              WHEN B.NO = 9 THEN BEFORE_UK_IDX_YN
              WHEN B.NO = 10 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DDL_IDX_PNM AS AFTER_DDL_IDX_PNM
               ,A.DDL_IDX_LNM AS AFTER_DDL_IDX_LNM
               ,A.DB_CONN_TRG_PNM AS AFTER_DB_CONN_TRG_PNM
               ,A.DB_SCH_PNM AS AFTER_DB_SCH_PNM
               ,A.DDL_TBL_PNM AS AFTER_DDL_TBL_PNM
               ,A.IDX_SPAC_PNM AS AFTER_IDX_SPAC_PNM
               ,C.COMM_DTL_CD_NM AS AFTER_IDX_TYP_CD
               ,CASE WHEN A.PK_IDX_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.PK_IDX_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_PK_IDX_YN
               ,CASE WHEN A.UK_IDX_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.UK_IDX_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_UK_IDX_YN
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_IDX_PNM AS BEFORE_DDL_IDX_PNM
               ,B.DDL_IDX_LNM AS BEFORE_DDL_IDX_LNM
               ,D.DB_CONN_TRG_PNM AS BEFORE_DB_CONN_TRG_PNM
               ,E.DB_SCH_PNM AS BEFORE_DB_SCH_PNM
               ,F.DDL_TBL_PNM AS BEFORE_DDL_TBL_PNM
               ,G.DB_TBL_SPAC_PNM AS BEFORE_IDX_SPAC_PNM
               ,H.COMM_DTL_CD_NM AS BEFORE_IDX_TYP_CD
               ,CASE WHEN B.PK_IDX_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.PK_IDX_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_PK_IDX_YN
               ,CASE WHEN B.UK_IDX_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.UK_IDX_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_UK_IDX_YN
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_IDX A
               LEFT OUTER JOIN WAM_DDL_IDX B
                 ON A.DDL_IDX_PNM = B.DDL_IDX_PNM
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_TYP_CD'
                                ) C
                 ON A.IDX_TYP_CD = C.COMM_DTL_CD    
               LEFT OUTER JOIN WAM_DDL_TBL F
                 ON B.DDL_TBL_ID = F.DDL_TBL_ID
                AND F.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN WAA_DB_CONN_TRG D
                 ON B.DB_CONN_TRG_ID = D.DB_CONN_TRG_ID
                AND D.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND D.REG_TYP_CD IN ('C', 'U')
			   LEFT OUTER JOIN WAA_DB_SCH E
                 ON B.DB_SCH_ID = E.DB_SCH_ID
                AND E.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND E.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN WAA_TBL_SPAC G
                 ON B.IDX_SPAC_ID = G.DB_TBL_SPAC_ID
                AND G.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND G.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_TYP_CD'
                                ) H
                 ON B.IDX_TYP_CD = H.COMM_DTL_CD  
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 10) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectDdlIdxColChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '인덱스컬럼물리명'
              WHEN B.NO = 2 THEN '인덱스컬럼논리명'
              WHEN B.NO = 3 THEN '인덱스컬럼순서'
              WHEN B.NO = 4 THEN '정렬순서'
              WHEN B.NO = 5 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_IDX_COL_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_IDX_COL_LNM
              WHEN B.NO = 3 THEN TO_CHAR(AFTER_DDL_IDX_COL_ORD)
              WHEN B.NO = 4 THEN AFTER_SORT_TYP
              WHEN B.NO = 5 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_IDX_COL_PNM
              WHEN B.NO = 2 THEN BEFORE_DDL_IDX_COL_LNM
              WHEN B.NO = 3 THEN TO_CHAR(BEFORE_DDL_IDX_COL_ORD)
              WHEN B.NO = 4 THEN BEFORE_SORT_TYP
              WHEN B.NO = 5 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.DDL_IDX_COL_PNM AS AFTER_DDL_IDX_COL_PNM
               ,A.DDL_IDX_COL_LNM AS AFTER_DDL_IDX_COL_LNM
               ,A.DDL_IDX_COL_ORD AS AFTER_DDL_IDX_COL_ORD
               ,C.COMM_DTL_CD_NM AS AFTER_SORT_TYP
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_IDX_COL_PNM AS BEFORE_DDL_IDX_COL_PNM
               ,B.DDL_IDX_COL_LNM AS BEFORE_DDL_IDX_COL_LNM
               ,B.DDL_IDX_COL_ORD AS BEFORE_DDL_IDX_COL_ORD
               ,D.COMM_DTL_CD_NM AS BEFORE_SORT_TYP
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_IDX_COL A
               LEFT OUTER JOIN WAM_DDL_IDX_COL B
                 ON A.DDL_IDX_COL_LNM = B.DDL_IDX_COL_LNM
                AND A.DDL_IDX_COL_PNM = B.DDL_IDX_COL_PNM
                AND A.DDL_IDX_ID = B.DDL_IDX_ID
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_COL_SRT_ORD_CD'
                                ) C
                 ON A.SORT_TYP = C.COMM_DTL_CD  
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_COL_SRT_ORD_CD'
                                ) D
                 ON B.SORT_TYP = D.COMM_DTL_CD  
               
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 5) B
         		]]>
         ORDER BY NO
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectDdlRelChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '관계물리명'
              WHEN B.NO = 2 THEN '관계논리명'
              WHEN B.NO = 3 THEN '관계유형'
              WHEN B.NO = 4 THEN '카디널리티유형'
              WHEN B.NO = 5 THEN 'Parent Optionality 유형'     
              WHEN B.NO = 6 THEN '부모엔터티 주제영역명'
              WHEN B.NO = 7 THEN '부모엔터티명'
              WHEN B.NO = 8 THEN '부모엔터티 속성명'
              WHEN B.NO = 9 THEN '자식엔터티 주제영역명'
              WHEN B.NO = 10 THEN '자식엔터티명'
              WHEN B.NO = 11 THEN '자식엔터티 속성명'
              WHEN B.NO = 12 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_REL_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_REL_LNM
              WHEN B.NO = 3 THEN AFTER_REL_TYP_CD
              WHEN B.NO = 4 THEN AFTER_CRD_TYP_CD
              WHEN B.NO = 5 THEN AFTER_PA_OPT_TYP_CD
              WHEN B.NO = 6 THEN AFTER_PA_SUBJ_PNM
              WHEN B.NO = 7 THEN AFTER_PA_ENTY_PNM
              WHEN B.NO = 8 THEN AFTER_PA_ATTR_PNM
              WHEN B.NO = 9 THEN AFTER_CH_SUBJ_PNM
              WHEN B.NO = 10 THEN AFTER_CH_ENTY_PNM
              WHEN B.NO = 11 THEN AFTER_CH_ATTR_PNM
              WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_REL_PNM
       		  WHEN B.NO = 2 THEN BEFORE_DDL_REL_LNM
              WHEN B.NO = 3 THEN BEFORE_REL_TYP_CD
              WHEN B.NO = 4 THEN BEFORE_CRD_TYP_CD
              WHEN B.NO = 5 THEN BEFORE_PA_OPT_TYP_CD
              WHEN B.NO = 6 THEN BEFORE_PA_SUBJ_PNM
              WHEN B.NO = 7 THEN BEFORE_PA_ENTY_PNM
              WHEN B.NO = 8 THEN BEFORE_PA_ATTR_PNM
              WHEN B.NO = 9 THEN BEFORE_CH_SUBJ_PNM
              WHEN B.NO = 10 THEN BEFORE_CH_ENTY_PNM
              WHEN B.NO = 11 THEN BEFORE_CH_ATTR_PNM
              WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN  
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.DDL_REL_PNM AS AFTER_DDL_REL_PNM
               ,A.DDL_REL_LNM AS AFTER_DDL_REL_LNM
               ,C.COMM_DTL_CD_NM AS AFTER_REL_TYP_CD
               ,D.COMM_DTL_CD_NM AS AFTER_CRD_TYP_CD
               ,E.COMM_DTL_CD_NM AS AFTER_PA_OPT_TYP_CD
               ,A.PA_SUBJ_PNM AS AFTER_PA_SUBJ_PNM
               ,A.PA_ENTY_PNM AS AFTER_PA_ENTY_PNM
               ,A.PA_ATTR_PNM AS AFTER_PA_ATTR_PNM
               ,A.CH_SUBJ_PNM AS AFTER_CH_SUBJ_PNM
               ,A.CH_ENTY_PNM AS AFTER_CH_ENTY_PNM
               ,A.CH_ATTR_PNM AS AFTER_CH_ATTR_PNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_REL_PNM AS BEFORE_DDL_REL_PNM
               ,B.DDL_REL_LNM AS BEFORE_DDL_REL_LNM
               ,F.COMM_DTL_CD_NM AS BEFORE_REL_TYP_CD
               ,G.COMM_DTL_CD_NM AS BEFORE_CRD_TYP_CD
               ,H.COMM_DTL_CD_NM AS BEFORE_PA_OPT_TYP_CD
               ,I.FULL_PATH AS BEFORE_PA_SUBJ_PNM
               ,J.DDL_TBL_PNM AS BEFORE_PA_ENTY_PNM
               ,K.DDL_COL_PNM AS BEFORE_PA_ATTR_PNM
               ,L.FULL_PATH AS BEFORE_CH_SUBJ_PNM
               ,M.DDL_TBL_PNM AS BEFORE_CH_ENTY_PNM
               ,N.DDL_COL_PNM AS BEFORE_CH_ATTR_PNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_REL A
               LEFT OUTER JOIN WAM_DDL_REL B
                 ON A.DDL_REL_PNM = B.DDL_REL_PNM
                AND A.CH_SUBJ_PNM = ( SELECT FULL_PATH
			   						   FROM WAA_SUBJ
			   						  WHERE SUBJ_ID = B.CH_SUBJ_ID
			   						    AND REG_TYP_CD IN ('C', 'U')
			   						    AND EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')  
			   					    )
				AND A.CH_ENTY_PNM = ( SELECT DDL_TBL_PNM
			   					 	   FROM WAM_DDL_TBL
			   					 	  WHERE DDL_TBL_ID = B.CH_ENTY_ID
			   					 	    AND REG_TYP_CD IN ('C', 'U')
			   					    )
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'REL_TYP_CD'
                                ) C
            ON A.REL_TYP_CD = C.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CRD_TYP_CD'
                                ) D
            ON A.CRD_TYP_CD = D.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'PA_OPT_TYP_CD'
                                ) E
            ON A.PA_OPT_TYP_CD = E.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'REL_TYP_CD'
                                ) F
            ON B.REL_TYP_CD = F.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CRD_TYP_CD'
                                ) G
            ON B.CRD_TYP_CD = G.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'PA_OPT_TYP_CD'
                                ) H
            ON B.PA_OPT_TYP_CD = H.COMM_DTL_CD
          LEFT OUTER JOIN WAA_SUBJ I
          	ON B.PA_SUBJ_ID = I.SUBJ_ID
           AND I.REG_TYP_CD IN ('C', 'U')
           AND I.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
          LEFT OUTER JOIN WAM_DDL_TBL J
            ON B.PA_ENTY_ID = J.DDL_TBL_ID
           AND J.REG_TYP_CD IN ('C', 'U')
          LEFT OUTER JOIN WAM_DDL_COL K
            ON B.PA_ATTR_ID = K.DDL_COL_ID
           AND B.PA_ENTY_ID = K.DDL_TBL_ID
          LEFT OUTER JOIN WAA_SUBJ L
          	ON B.CH_SUBJ_ID = L.SUBJ_ID
           AND L.REG_TYP_CD IN ('C', 'U')
           AND L.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
          LEFT OUTER JOIN WAM_DDL_TBL M
            ON B.CH_ENTY_ID = M.DDL_TBL_ID
           AND M.REG_TYP_CD IN ('C', 'U')
          LEFT OUTER JOIN WAM_DDL_COL N
            ON B.CH_ATTR_ID = N.DDL_COL_ID
           AND B.CH_ENTY_ID = N.DDL_TBL_ID
			   
               
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 12) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectDdlTsfTblChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '테이블논리명'
              WHEN B.NO = 2 THEN '테이블물리명'
              WHEN B.NO = 3 THEN '소스DB스키마명'
              WHEN B.NO = 4 THEN '타겟DB스키마명'
              WHEN B.NO = 5 THEN '테이블스페이스명'
              WHEN B.NO = 6 THEN '파티션여부'
              WHEN B.NO = 7 THEN '개인정보분리보관여부'
              WHEN B.NO = 8 THEN '설명'
              
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_TBL_LNM
              WHEN B.NO = 2 THEN AFTER_DDL_TBL_PNM
              WHEN B.NO = 3 THEN AFTER_SRC_DB_SCH_PNM
              WHEN B.NO = 4 THEN AFTER_TGT_DB_SCH_PNM
              WHEN B.NO = 5 THEN AFTER_TBL_SPAC_PNM
              WHEN B.NO = 6 THEN AFTER_PART_TBL_YN
              WHEN B.NO = 7 THEN AFTER_PCI_YN
              WHEN B.NO = 8 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_TBL_LNM
              WHEN B.NO = 2 THEN BEFORE_DDL_TBL_PNM
              WHEN B.NO = 3 THEN BEFORE_SRC_DB_SCH_PNM
              WHEN B.NO = 4 THEN BEFORE_TGT_DB_SCH_PNM
              WHEN B.NO = 5 THEN BEFORE_TBL_SPAC_PNM
              WHEN B.NO = 6 THEN BEFORE_PART_TBL_YN
              WHEN B.NO = 7 THEN BEFORE_PCI_YN
              WHEN B.NO = 8 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DDL_TBL_LNM AS AFTER_DDL_TBL_LNM
               ,A.DDL_TBL_PNM AS AFTER_DDL_TBL_PNM
               ,A.SRC_DB_SCH_PNM AS AFTER_SRC_DB_SCH_PNM
               ,A.TGT_DB_SCH_PNM AS AFTER_TGT_DB_SCH_PNM
               ,A.TBL_SPAC_PNM AS AFTER_TBL_SPAC_PNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_TBL_LNM AS BEFORE_DDL_TBL_LNM
               ,B.DDL_TBL_PNM AS BEFORE_DDL_TBL_PNM
               ,C.DB_SCH_PNM AS BEFORE_SRC_DB_SCH_PNM
               ,D.DB_SCH_PNM AS BEFORE_TGT_DB_SCH_PNM
               ,E.DB_TBL_SPAC_PNM AS BEFORE_TBL_SPAC_PNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
               ,B.PART_TBL_YN AS BEFORE_PART_TBL_YN
               ,A.PART_TBL_YN AS AFTER_PART_TBL_YN
               ,B.PCI_YN      AS BEFORE_PCI_YN
               ,A.PCI_YN      AS AFTER_PCI_YN
          FROM WAQ_DDL_TSF_TBL A
               LEFT OUTER JOIN WAM_DDL_TSF_TBL B
                 ON A.DDL_TBL_PNM = B.DDL_TBL_PNM
                AND A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID
                AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID
			   LEFT OUTER JOIN  WAA_DB_SCH C
                 ON B.SRC_DB_SCH_ID = C.DB_SCH_ID
                AND C.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND C.REG_TYP_CD IN ('C', 'U')
			   LEFT OUTER JOIN  WAA_DB_SCH D
                 ON B.TGT_DB_SCH_ID = D.DB_SCH_ID
                AND D.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND D.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN WAA_TBL_SPAC E
                 ON B.TBL_SPAC_ID = E.DB_TBL_SPAC_ID
                AND E.REG_TYP_CD IN ('C', 'U')
                AND E.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 8) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  
  <select id="selectDdlTsfIdxChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '인덱스물리명'
              WHEN B.NO = 2 THEN '인덱스논리명'
              WHEN B.NO = 3 THEN '소스DB스키마명'
              WHEN B.NO = 4 THEN '타겟DB스키마명'
              WHEN B.NO = 5 THEN '인덱스스페이스명'
              WHEN B.NO = 6 THEN '설명'
              
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_IDX_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_IDX_LNM
              WHEN B.NO = 3 THEN AFTER_SRC_DB_SCH_PNM
              WHEN B.NO = 4 THEN AFTER_TGT_DB_SCH_PNM
              WHEN B.NO = 5 THEN AFTER_IDX_SPAC_PNM
              WHEN B.NO = 6 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_IDX_PNM
              WHEN B.NO = 2 THEN BEFORE_DDL_IDX_LNM
              WHEN B.NO = 3 THEN BEFORE_SRC_DB_SCH_PNM
              WHEN B.NO = 4 THEN BEFORE_TGT_DB_SCH_PNM
              WHEN B.NO = 5 THEN BEFORE_IDX_SPAC_PNM
              WHEN B.NO = 6 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DDL_IDX_PNM AS AFTER_DDL_IDX_PNM
               ,A.DDL_IDX_LNM AS AFTER_DDL_IDX_LNM
               ,A.SRC_DB_SCH_PNM AS AFTER_SRC_DB_SCH_PNM
               ,A.TGT_DB_SCH_PNM AS AFTER_TGT_DB_SCH_PNM
               ,A.IDX_SPAC_PNM AS AFTER_IDX_SPAC_PNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_IDX_PNM AS BEFORE_DDL_IDX_PNM
               ,B.DDL_IDX_LNM AS BEFORE_DDL_IDX_LNM
               ,D.DB_SCH_PNM AS BEFORE_SRC_DB_SCH_PNM
               ,E.DB_SCH_PNM AS BEFORE_TGT_DB_SCH_PNM
               ,G.DB_TBL_SPAC_PNM AS BEFORE_IDX_SPAC_PNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_TSF_IDX A
               LEFT OUTER JOIN WAM_DDL_TSF_IDX B
                 ON A.DDL_IDX_PNM = B.DDL_IDX_PNM
                AND A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID
                AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID
			   LEFT OUTER JOIN WAA_DB_SCH D
                 ON B.SRC_DB_SCH_ID = D.DB_SCH_ID
                AND D.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND D.REG_TYP_CD IN ('C', 'U')
			   LEFT OUTER JOIN WAA_DB_SCH E
                 ON B.TGT_DB_SCH_ID = E.DB_SCH_ID
                AND E.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND E.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN WAA_TBL_SPAC G
                 ON B.IDX_SPAC_ID = G.DB_TBL_SPAC_ID
                AND G.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                AND G.REG_TYP_CD IN ('C', 'U')
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 6) B
         		]]>
<!--        (SELECT 1 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 2 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 3 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 4 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 5 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 6 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 7 AS NO FROM DUAL -->
<!--         UNION ALL -->
<!--         SELECT 8 AS NO FROM DUAL) B  -->
   )
  </select>
  <select id="selectMsgChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
          <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '메시지코드'
                WHEN NO = 2 THEN '메시지내용'
                WHEN NO = 3 THEN '유형구분코드'
                WHEN NO = 4 THEN '업무구분코드'
                WHEN NO = 5 THEN '사용여부'
                WHEN NO = 6 THEN '설명' 
                END AS ITEM_NM
               ,CASE WHEN NO = 1 THEN BEFORE_MSG_CD 
                WHEN NO = 2 THEN BEFORE_MSG_CONTS
                WHEN NO = 3 THEN BEFORE_TYP_DIV_CD
                WHEN NO = 4 THEN BEFORE_BIZ_DIV_CD
                WHEN NO = 5 THEN BEFORE_USE_YN
                WHEN NO = 6 THEN BEFORE_OBJ_DESCN
               END AS BEFORE
               ,CASE WHEN NO = 1 THEN AFTER_MSG_CD 
                WHEN NO = 2 THEN AFTER_MSG_CONTS
                WHEN NO = 3 THEN AFTER_TYP_DIV_CD
                WHEN NO = 4 THEN AFTER_BIZ_DIV_CD
                WHEN NO = 5 THEN AFTER_USE_YN
                WHEN NO = 6 THEN AFTER_OBJ_DESCN
               END AS AFTER
        FROM 
            (SELECT
                   A.RQST_NO
                  ,A.RQST_SNO
                  ,B.MSG_CD BEFORE_MSG_CD
                  ,A.MSG_CD AFTER_MSG_CD
                  ,B.MSG_CONTS AS BEFORE_MSG_CONTS
                  ,A.MSG_CONTS AS AFTER_MSG_CONTS
                  ,B.TYP_DIV_CD BEFORE_TYP_DIV_CD
                  ,A.TYP_DIV_CD AFTER_TYP_DIV_CD
                  ,B.BIZ_DIV_CD BEFORE_BIZ_DIV_CD
                  ,A.BIZ_DIV_CD AFTER_BIZ_DIV_CD
                  ,B.USE_YN BEFORE_USE_YN
                  ,A.USE_YN AFTER_USE_YN
                  ,B.OBJ_DESCN BEFORE_OBJ_DESCN
                  ,A.OBJ_DESCN AFTER_OBJ_DESCN
            FROM WAQ_MSG A
            INNER JOIN WAM_MSG B
            ON A.MSG_CD = B.MSG_CD
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,  (SELECT LEVEL AS NO 
            FROM DUAL
           <![CDATA[
            CONNECT BY LEVEL <= 6) B
           ]]>
)
    

  </select>
   <select id="selectCdValChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
          <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '코드값'
                WHEN NO = 2 THEN '코드값명'
                --WHEN NO = 3 THEN '상위코드값'
                WHEN NO = 3 THEN '표시순서'
                WHEN NO = 4 THEN '사용여부' 
                --WHEN NO = 6 THEN '기타1' 
                --WHEN NO = 7 THEN '기타1명' 
                --WHEN NO = 8 THEN '기타2' 
                --WHEN NO = 9 THEN '기타2명' 
                --WHEN NO = 10 THEN '기타3' 
                --WHEN NO = 11 THEN '기타3명' 
                --WHEN NO = 12 THEN '기타4' 
                --WHEN NO = 13 THEN '기타5명' 
                --WHEN NO = 14 THEN '기타5' 
                --WHEN NO = 15 THEN '기타5명' 
                --WHEN NO = 16 THEN '적요1' 
                --WHEN NO = 17 THEN '적요2' 
                WHEN NO = 5 THEN '비고' 
                END AS ITEM_NM
               ,CASE WHEN NO = 1  THEN BEFORE_CD_VAL 
                     WHEN NO = 2  THEN BEFORE_CD_VAL_NM  
                    -- WHEN NO = 3  THEN BEFORE_UPP_CD_VAL 
                     WHEN NO = 3  THEN BEFORE_DISP_ORD 
                     WHEN NO = 4  THEN BEFORE_USE_YN
                     --WHEN NO = 6  THEN BEFORE_VV_NOTE1 
                     --WHEN NO = 7  THEN BEFORE_VV_NOTE_NM1 
                     --WHEN NO = 8  THEN BEFORE_VV_NOTE2 
                     --WHEN NO = 9  THEN BEFORE_VV_NOTE_NM2 
                     --WHEN NO = 10 THEN BEFORE_VV_NOTE3 
                     --WHEN NO = 11 THEN BEFORE_VV_NOTE_NM3 
                     --WHEN NO = 12 THEN BEFORE_VV_NOTE4 
                     --WHEN NO = 13 THEN BEFORE_VV_NOTE_NM4 
                     --WHEN NO = 14 THEN BEFORE_VV_NOTE5
                     --WHEN NO = 15 THEN BEFORE_VV_NOTE_NM5
                     --WHEN NO = 16 THEN BEFORE_OUTL_CNTN1 
                     --WHEN NO = 17 THEN BEFORE_OUTL_CNTN2
                     WHEN NO = 5 THEN BEFORE_OBJ_DESCN 
               END AS BEFORE
               ,CASE WHEN NO = 1  THEN AFTER_CD_VAL 
                     WHEN NO = 2  THEN AFTER_CD_VAL_NM  
                     --WHEN NO = 3  THEN AFTER_UPP_CD_VAL 
                     WHEN NO = 3  THEN AFTER_DISP_ORD 
                     WHEN NO = 4  THEN AFTER_USE_YN
                     --WHEN NO = 6  THEN AFTER_VV_NOTE1 
                     --WHEN NO = 7  THEN AFTER_VV_NOTE_NM1 
                     --WHEN NO = 8  THEN AFTER_VV_NOTE2 
                     --WHEN NO = 9  THEN AFTER_VV_NOTE_NM2 
                     --WHEN NO = 10 THEN AFTER_VV_NOTE3 
                     --WHEN NO = 11 THEN AFTER_VV_NOTE_NM3 
                     --WHEN NO = 12 THEN AFTER_VV_NOTE4 
                     --WHEN NO = 13 THEN AFTER_VV_NOTE_NM4 
                     --WHEN NO = 14 THEN AFTER_VV_NOTE5
                     --WHEN NO = 15 THEN AFTER_VV_NOTE_NM5
                     --WHEN NO = 16 THEN AFTER_OUTL_CNTN1 
                     --WHEN NO = 17 THEN AFTER_OUTL_CNTN2
                     WHEN NO = 5 THEN AFTER_OBJ_DESCN 
               END AS AFTER
        FROM 
            (SELECT
                   A.RQST_NO
                  ,A.RQST_SNO
                  ,B.CD_VAL BEFORE_CD_VAL
                  ,A.CD_VAL AFTER_CD_VAL
                  ,B.CD_VAL_NM AS BEFORE_CD_VAL_NM
                  ,A.CD_VAL_NM AS AFTER_CD_VAL_NM
<!--                   ,GET_CD_VAL_NM(B.UPP_CD_VAL_ID) BEFORE_UPP_CD_VAL -->
<!--                   ,A.UPP_CD_VAL AFTER_UPP_CD_VAL -->
                  ,B.OBJ_DESCN BEFORE_OBJ_DESCN
                  ,A.OBJ_DESCN AFTER_OBJ_DESCN
<!--                   ,B.VV_NOTE1 BEFORE_VV_NOTE1 -->
<!--                   ,A.VV_NOTE1 AFTER_VV_NOTE1 -->
<!--                   ,B.VV_NOTE_NM1 BEFORE_VV_NOTE_NM1 -->
<!--                   ,A.VV_NOTE_NM1 AFTER_VV_NOTE_NM1 -->
<!--                   ,B.VV_NOTE2 BEFORE_VV_NOTE2 -->
<!--                   ,A.VV_NOTE2 AFTER_VV_NOTE2 -->
<!--                   ,B.VV_NOTE_NM2 BEFORE_VV_NOTE_NM2 -->
<!--                   ,A.VV_NOTE_NM2 AFTER_VV_NOTE_NM2 -->
<!--                   ,B.VV_NOTE3 BEFORE_VV_NOTE3 -->
<!--                   ,A.VV_NOTE3 AFTER_VV_NOTE3 -->
<!--                   ,B.VV_NOTE_NM3 BEFORE_VV_NOTE_NM3 -->
<!--                   ,A.VV_NOTE_NM3 AFTER_VV_NOTE_NM3 -->
<!--                   ,B.VV_NOTE4 BEFORE_VV_NOTE4 -->
<!--                   ,A.VV_NOTE4 AFTER_VV_NOTE4 -->
<!--                   ,B.VV_NOTE_NM4 BEFORE_VV_NOTE_NM4 -->
<!--                   ,A.VV_NOTE_NM4 AFTER_VV_NOTE_NM4 -->
<!--                   ,B.VV_NOTE5 BEFORE_VV_NOTE5 -->
<!--                   ,A.VV_NOTE5 AFTER_VV_NOTE5 -->
<!--                   ,B.VV_NOTE_NM5 BEFORE_VV_NOTE_NM5 -->
<!--                   ,A.VV_NOTE_NM5 AFTER_VV_NOTE_NM5 -->
<!--                   ,B.OUTL_CNTN1 BEFORE_OUTL_CNTN1 -->
<!--                   ,A.OUTL_CNTN1 AFTER_OUTL_CNTN1 -->
<!--                   ,B.OUTL_CNTN2 BEFORE_OUTL_CNTN2 -->
<!--                   ,A.OUTL_CNTN2 AFTER_OUTL_CNTN2 -->
                  ,B.USE_YN BEFORE_USE_YN
                  ,A.USE_YN AFTER_USE_YN
                  ,TO_CHAR(B.DISP_ORD) BEFORE_DISP_ORD
                  ,TO_CHAR(A.DISP_ORD) AFTER_DISP_ORD
            FROM WAQ_CD_VAL A
            INNER JOIN WAM_CD_VAL B
            ON A.CD_VAL_ID = B.CD_VAL_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO =  #{rqstSno,jdbcType=DECIMAL}
            AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}) A
        ,  (SELECT LEVEL AS NO 
            FROM DUAL
             <![CDATA[
             CONNECT BY LEVEL <= 5) B
             ]]>
             )

  </select>
  
     <select id="selectCodeTsfChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
          <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '코드값'
                WHEN NO = 2 THEN '코드값명'
                WHEN NO = 3 THEN '상위코드값'
                WHEN NO = 4 THEN '표시순서'
                WHEN NO = 5 THEN '사용여부' 
                WHEN NO = 6 THEN '기타1' 
                WHEN NO = 7 THEN '기타1명' 
                WHEN NO = 8 THEN '기타2' 
                WHEN NO = 9 THEN '기타2명' 
                WHEN NO = 10 THEN '기타3' 
                WHEN NO = 11 THEN '기타3명' 
                WHEN NO = 12 THEN '기타4' 
                WHEN NO = 13 THEN '기타5명' 
                WHEN NO = 14 THEN '기타5' 
                WHEN NO = 15 THEN '기타5명' 
                WHEN NO = 16 THEN '적요1' 
                WHEN NO = 17 THEN '적요2' 
                WHEN NO = 18 THEN '비고' 
                END AS ITEM_NM
               ,CASE WHEN NO = 1  THEN BEFORE_CD_VAL 
                     WHEN NO = 2  THEN BEFORE_CD_VAL_NM  
                     WHEN NO = 3  THEN BEFORE_UPP_CD_VAL 
                     WHEN NO = 4  THEN BEFORE_DISP_ORD 
                     WHEN NO = 5  THEN BEFORE_USE_YN
                     WHEN NO = 6  THEN BEFORE_VV_NOTE1 
                     WHEN NO = 7  THEN BEFORE_VV_NOTE_NM1 
                     WHEN NO = 8  THEN BEFORE_VV_NOTE2 
                     WHEN NO = 9  THEN BEFORE_VV_NOTE_NM2 
                     WHEN NO = 10 THEN BEFORE_VV_NOTE3 
                     WHEN NO = 11 THEN BEFORE_VV_NOTE_NM3 
                     WHEN NO = 12 THEN BEFORE_VV_NOTE4 
                     WHEN NO = 13 THEN BEFORE_VV_NOTE_NM4 
                     WHEN NO = 14 THEN BEFORE_VV_NOTE5
                     WHEN NO = 15 THEN BEFORE_VV_NOTE_NM5
                     WHEN NO = 16 THEN BEFORE_OUTL_CNTN1 
                     WHEN NO = 17 THEN BEFORE_OUTL_CNTN2
                     WHEN NO = 18 THEN BEFORE_OBJ_DESCN 
               END AS BEFORE
               ,CASE WHEN NO = 1  THEN AFTER_CD_VAL 
                     WHEN NO = 2  THEN AFTER_CD_VAL_NM  
                     WHEN NO = 3  THEN AFTER_UPP_CD_VAL 
                     WHEN NO = 4  THEN AFTER_DISP_ORD 
                     WHEN NO = 5  THEN AFTER_USE_YN
                     WHEN NO = 6  THEN AFTER_VV_NOTE1 
                     WHEN NO = 7  THEN AFTER_VV_NOTE_NM1 
                     WHEN NO = 8  THEN AFTER_VV_NOTE2 
                     WHEN NO = 9  THEN AFTER_VV_NOTE_NM2 
                     WHEN NO = 10 THEN AFTER_VV_NOTE3 
                     WHEN NO = 11 THEN AFTER_VV_NOTE_NM3 
                     WHEN NO = 12 THEN AFTER_VV_NOTE4 
                     WHEN NO = 13 THEN AFTER_VV_NOTE_NM4 
                     WHEN NO = 14 THEN AFTER_VV_NOTE5
                     WHEN NO = 15 THEN AFTER_VV_NOTE_NM5
                     WHEN NO = 16 THEN AFTER_OUTL_CNTN1 
                     WHEN NO = 17 THEN AFTER_OUTL_CNTN2
                     WHEN NO = 18 THEN AFTER_OBJ_DESCN 
               END AS AFTER
        FROM 
            (SELECT
                   A.RQST_NO
                  ,A.RQST_SNO
                  ,B.CD_VAL BEFORE_CD_VAL
                  ,A.CD_VAL AFTER_CD_VAL
                  ,B.CD_VAL_NM AS BEFORE_CD_VAL_NM
                  ,A.CD_VAL_NM AS AFTER_CD_VAL_NM
                  ,GET_CD_VAL_NM(B.UPP_CD_VAL_ID) BEFORE_UPP_CD_VAL
                  ,A.UPP_CD_VAL AFTER_UPP_CD_VAL
                  ,B.OBJ_DESCN BEFORE_OBJ_DESCN
                  ,A.OBJ_DESCN AFTER_OBJ_DESCN
                  ,B.VV_NOTE1 BEFORE_VV_NOTE1
                  ,A.VV_NOTE1 AFTER_VV_NOTE1
                  ,B.VV_NOTE_NM1 BEFORE_VV_NOTE_NM1
                  ,A.VV_NOTE_NM1 AFTER_VV_NOTE_NM1
                  ,B.VV_NOTE2 BEFORE_VV_NOTE2
                  ,A.VV_NOTE2 AFTER_VV_NOTE2
                  ,B.VV_NOTE_NM2 BEFORE_VV_NOTE_NM2
                  ,A.VV_NOTE_NM2 AFTER_VV_NOTE_NM2
                  ,B.VV_NOTE3 BEFORE_VV_NOTE3
                  ,A.VV_NOTE3 AFTER_VV_NOTE3
                  ,B.VV_NOTE_NM3 BEFORE_VV_NOTE_NM3
                  ,A.VV_NOTE_NM3 AFTER_VV_NOTE_NM3
                  ,B.VV_NOTE4 BEFORE_VV_NOTE4
                  ,A.VV_NOTE4 AFTER_VV_NOTE4
                  ,B.VV_NOTE_NM4 BEFORE_VV_NOTE_NM4
                  ,A.VV_NOTE_NM4 AFTER_VV_NOTE_NM4
                  ,B.VV_NOTE5 BEFORE_VV_NOTE5
                  ,A.VV_NOTE5 AFTER_VV_NOTE5
                  ,B.VV_NOTE_NM5 BEFORE_VV_NOTE_NM5
                  ,A.VV_NOTE_NM5 AFTER_VV_NOTE_NM5
                  ,B.OUTL_CNTN1 BEFORE_OUTL_CNTN1
                  ,A.OUTL_CNTN1 AFTER_OUTL_CNTN1
                  ,B.OUTL_CNTN2 BEFORE_OUTL_CNTN2
                  ,A.OUTL_CNTN2 AFTER_OUTL_CNTN2
                  ,B.USE_YN BEFORE_USE_YN
                  ,A.USE_YN AFTER_USE_YN
                  ,TO_CHAR(B.DISP_ORD) BEFORE_DISP_ORD
                  ,TO_CHAR(A.DISP_ORD) AFTER_DISP_ORD
            FROM WAQ_CD_VAL_TSF A
            INNER JOIN WAM_CD_VAL_TSF B
            ON A.CD_VAL_ID = B.CD_VAL_ID
            AND A.TGT_DB_CONN_TRG_ID = B.TGT_DB_CONN_TRG_ID
            AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO =  #{rqstSno,jdbcType=DECIMAL}
            ) A
        ,  (SELECT LEVEL AS NO 
            FROM DUAL
             <![CDATA[
             CONNECT BY LEVEL <= 18) B
             ]]>
             )

  </select>

<select id="selectMsgTsfChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
          <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '메시지코드'
                WHEN NO = 2 THEN '메시지내용'
                WHEN NO = 3 THEN '유형구분코드'
                WHEN NO = 4 THEN '업무구분코드'
                WHEN NO = 5 THEN '사용여부'
                WHEN NO = 6 THEN '설명'  
                END AS ITEM_NM
               ,CASE WHEN NO = 1 THEN BEFORE_MSG_CD 
                WHEN NO = 2 THEN BEFORE_MSG_CONTS
                WHEN NO = 3 THEN BEFORE_TYP_DIV_CD
                WHEN NO = 4 THEN BEFORE_BIZ_DIV_CD
                WHEN NO = 5 THEN BEFORE_USE_YN
                WHEN NO = 6 THEN BEFORE_OBJ_DESCN
               END AS BEFORE
               ,CASE WHEN NO = 1 THEN AFTER_MSG_CD 
                WHEN NO = 2 THEN AFTER_MSG_CONTS
                WHEN NO = 3 THEN AFTER_TYP_DIV_CD
                WHEN NO = 4 THEN AFTER_BIZ_DIV_CD
                WHEN NO = 5 THEN AFTER_USE_YN
                WHEN NO = 6 THEN AFTER_OBJ_DESCN
               END AS AFTER
        FROM 
            (SELECT
                   A.RQST_NO
                  ,A.RQST_SNO
                  ,B.MSG_CD BEFORE_MSG_CD
                  ,A.MSG_CD AFTER_MSG_CD
                  ,B.MSG_CONTS AS BEFORE_MSG_CONTS
                  ,A.MSG_CONTS AS AFTER_MSG_CONTS
                  ,B.TYP_DIV_CD BEFORE_TYP_DIV_CD
                  ,A.TYP_DIV_CD AFTER_TYP_DIV_CD
                  ,B.BIZ_DIV_CD BEFORE_BIZ_DIV_CD
                  ,A.BIZ_DIV_CD AFTER_BIZ_DIV_CD
                  ,B.USE_YN BEFORE_USE_YN
                  ,A.USE_YN AFTER_USE_YN
                  ,B.OBJ_DESCN BEFORE_OBJ_DESCN
                  ,A.OBJ_DESCN AFTER_OBJ_DESCN
            FROM WAQ_MSG_TSF A
            INNER JOIN WAM_MSG_TSF B
            ON A.MSG_ID = B.MSG_ID
            AND A.TGT_DB_CONN_TRG_ID = B.TGT_DB_CONN_TRG_ID
            AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,  (SELECT LEVEL AS NO 
            FROM DUAL
           <![CDATA[
            CONNECT BY LEVEL <= 6) B
           ]]>
)
 </select>
 
   <select id="selectDdlColTsfChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '컬럼논리명'
              WHEN B.NO = 2 THEN '컬럼물리명'
              WHEN B.NO = 3 THEN '컬럼순서'
              WHEN B.NO = 4 THEN '데이터타입'
              WHEN B.NO = 5 THEN '데이터길이'     
              WHEN B.NO = 6 THEN '데이터소수점길이'
              WHEN B.NO = 7 THEN 'PK여부'
              WHEN B.NO = 8 THEN 'PK순서'
              WHEN B.NO = 9 THEN 'NOTNULL여부'
              WHEN B.NO = 10 THEN 'DEFAULT값'
              WHEN B.NO = 11 THEN '설명'
              WHEN B.NO = 12 THEN '암호화여부'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_COL_LNM
              WHEN B.NO = 2 THEN AFTER_DDL_COL_PNM
              WHEN B.NO = 3 THEN TO_CHAR(AFTER_COL_ORD)
              WHEN B.NO = 4 THEN AFTER_DATA_TYPE
              WHEN B.NO = 5 THEN TO_CHAR(AFTER_DATA_LEN)
              WHEN B.NO = 6 THEN TO_CHAR(AFTER_DATA_SCAL)
              WHEN B.NO = 7 THEN AFTER_PK_YN
              WHEN B.NO = 8 THEN TO_CHAR(AFTER_PK_ORD)
              WHEN B.NO = 9 THEN AFTER_NONUL_YN
              WHEN B.NO = 10 THEN AFTER_DEFLT_VAL
              WHEN B.NO = 11 THEN AFTER_OBJ_DESCN
              WHEN B.NO = 12 THEN AFTER_ENC_YN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_COL_LNM
              WHEN B.NO = 2 THEN BEFORE_DDL_COL_PNM
              WHEN B.NO = 3 THEN TO_CHAR(BEFORE_COL_ORD)
              WHEN B.NO = 4 THEN BEFORE_DATA_TYPE
              WHEN B.NO = 5 THEN TO_CHAR(BEFORE_DATA_LEN)
              WHEN B.NO = 6 THEN TO_CHAR(BEFORE_DATA_SCAL)
              WHEN B.NO = 7 THEN BEFORE_PK_YN
              WHEN B.NO = 8 THEN TO_CHAR(BEFORE_PK_ORD)
              WHEN B.NO = 9 THEN BEFORE_NONUL_YN
              WHEN B.NO = 10 THEN BEFORE_DEFLT_VAL
              WHEN B.NO = 11 THEN BEFORE_OBJ_DESCN
              WHEN B.NO = 12 THEN BEFORE_ENC_YN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.DDL_COL_LNM AS AFTER_DDL_COL_LNM
               ,A.DDL_COL_PNM AS AFTER_DDL_COL_PNM
               ,A.COL_ORD AS AFTER_COL_ORD
               ,A.DATA_TYPE AS AFTER_DATA_TYPE
               ,A.DATA_LEN AS AFTER_DATA_LEN
               ,A.DATA_SCAL AS AFTER_DATA_SCAL
               ,CASE WHEN A.PK_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.PK_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_PK_YN
               ,A.PK_ORD AS AFTER_PK_ORD
               ,CASE WHEN A.NONUL_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.NONUL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_NONUL_YN
               ,A.DEFLT_VAL AS AFTER_DEFLT_VAL
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_COL_LNM AS BEFORE_DDL_COL_LNM
               ,B.DDL_COL_PNM AS BEFORE_DDL_COL_PNM
               ,B.COL_ORD AS BEFORE_COL_ORD
               ,B.DATA_TYPE AS BEFORE_DATA_TYPE
               ,B.DATA_LEN AS BEFORE_DATA_LEN
               ,B.DATA_SCAL AS BEFORE_DATA_SCAL
               ,CASE WHEN B.PK_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.PK_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_PK_YN
               ,B.PK_ORD AS BEFORE_PK_ORD
               ,CASE WHEN B.NONUL_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.NONUL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_NONUL_YN
               ,B.DEFLT_VAL AS BEFORE_DEFLT_VAL
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
               ,B.ENC_YN AS BEFORE_ENC_YN
               ,A.ENC_YN AS AFTER_ENC_YN
          FROM WAQ_DDL_TSF_COL A
               LEFT OUTER JOIN (SELECT A.*
		                                       ,B.DDL_TBL_PNM
		                                  FROM WAM_DDL_TSF_COL A
		                                       INNER JOIN WAM_DDL_TSF_TBL B
		                                          ON A.DDL_TBL_ID = B.DDL_TBL_ID
		                                         AND A.REG_TYP_CD IN ('C','U')
		                                         AND B.REG_TYP_CD IN ('C','U')
		                                WHERE B.DDL_TBL_PNM = #{searchObj,jdbcType=VARCHAR}  ) B
                 ON A.DDL_TBL_PNM = B.DDL_TBL_PNM
                AND A.DDL_COL_PNM = B.DDL_COL_PNM                                         
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 12) B
         		]]>
   )
  </select>
    <select id="selectDdlIdxColTsfChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
         <![CDATA[
         , (CASE WHEN NVL(AFTER, '_') <> NVL(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '인덱스컬럼물리명'
              WHEN B.NO = 2 THEN '인덱스컬럼논리명'
              WHEN B.NO = 3 THEN '인덱스컬럼순서'
              WHEN B.NO = 4 THEN '정렬순서'
              WHEN B.NO = 5 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_IDX_COL_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_IDX_COL_LNM
              WHEN B.NO = 3 THEN TO_CHAR(AFTER_DDL_IDX_COL_ORD)
              WHEN B.NO = 4 THEN AFTER_SORT_TYP
              WHEN B.NO = 5 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_IDX_COL_PNM
              WHEN B.NO = 2 THEN BEFORE_DDL_IDX_COL_LNM
              WHEN B.NO = 3 THEN TO_CHAR(BEFORE_DDL_IDX_COL_ORD)
              WHEN B.NO = 4 THEN BEFORE_SORT_TYP
              WHEN B.NO = 5 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.DDL_IDX_COL_PNM AS AFTER_DDL_IDX_COL_PNM
               ,A.DDL_IDX_COL_LNM AS AFTER_DDL_IDX_COL_LNM
               ,A.DDL_IDX_COL_ORD AS AFTER_DDL_IDX_COL_ORD
               ,C.COMM_DTL_CD_NM AS AFTER_SORT_TYP
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_IDX_COL_PNM AS BEFORE_DDL_IDX_COL_PNM
               ,B.DDL_IDX_COL_LNM AS BEFORE_DDL_IDX_COL_LNM
               ,B.DDL_IDX_COL_ORD AS BEFORE_DDL_IDX_COL_ORD
               ,D.COMM_DTL_CD_NM AS BEFORE_SORT_TYP
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_TSF_IDX_COL A
               LEFT OUTER JOIN WAM_DDL_TSF_IDX_COL B
                 ON A.DDL_IDX_COL_LNM = B.DDL_IDX_COL_LNM
                AND A.DDL_IDX_COL_PNM = B.DDL_IDX_COL_PNM
                AND A.DDL_IDX_ID = B.DDL_IDX_ID
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_COL_SRT_ORD_CD'
                                ) C
                 ON A.SORT_TYP = C.COMM_DTL_CD  
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = DATE_FORMAT( '9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_COL_SRT_ORD_CD'
                                ) D
                 ON B.SORT_TYP = D.COMM_DTL_CD  
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT LEVEL AS NO 
          FROM DUAL
          <![CDATA[
         CONNECT BY LEVEL <= 5) B
         		]]>
         ORDER BY NO
   )
  </select> 
</mapper>